CONNECTION0* - 	jdbc:derby:C:\_JSM\SeguimientoCartera\03_Fuentes\markets_data\SeguimientoCartera\derby\seguimiento_cartera
* = current connection
ij> /*

connect 'jdbc:derby:C:\\_JSM\\SeguimientoCartera\\03_Fuentes\\markets_data\\SeguimientoCartera\\derby\\seguimiento_cartera;create=true';
connect 'jdbc:derby:C:\\_JSM\\SeguimientoCartera\\03_Fuentes\\markets_data\\SeguimientoCartera\\derby\\seguimiento_cartera';
run 'C:\_JSM\SeguimientoCartera\03_Fuentes\markets_data\SeguimientoCartera\resources\input.seguimiento_cartera.sql';
commit;
exit;

*/
AUTOCOMMIT OFF;
ij> --
--
--
DROP VIEW VWF_COMERCIALIZADOR;
0 rows inserted/updated/deleted
ij> DROP VIEW VWF_GAN_PER_PROD_PESO_GLOBAL;
0 rows inserted/updated/deleted
ij> DROP VIEW VWF_GAN_PER_PROD_PESO_GLOBAL_TOTALES;
0 rows inserted/updated/deleted
ij> DROP VIEW VWF_INSTRUMENTO;
0 rows inserted/updated/deleted
ij> DROP VIEW VWF_MERCADO;
0 rows inserted/updated/deleted
ij> DROP VIEW VWF_MONEDA;
0 rows inserted/updated/deleted
ij> DROP VIEW VWF_PROVEEDOR;
0 rows inserted/updated/deleted
ij> DROP VIEW VWF_TIPO_ACTIVO;
0 rows inserted/updated/deleted
ij> DROP VIEW VWF_SUBTIPO_ACTIVO_ORO;
0 rows inserted/updated/deleted
ij> DROP VIEW VWF_SUBTIPO_ACTIVO_RF;
0 rows inserted/updated/deleted
ij> DROP VIEW VWF_SUBTIPO_ACTIVO_RV;
0 rows inserted/updated/deleted
ij> DROP VIEW VWF_SUBTIPO_ACTIVO_GLOBAL;
0 rows inserted/updated/deleted
ij> DROP VIEW VWF_USO_INGRESOS;
0 rows inserted/updated/deleted
ij> DROP VIEW VWF_EFECTIVO;
0 rows inserted/updated/deleted
ij> DROP VIEW VW03_GAN_PER_PROD_PESO_ORO;
0 rows inserted/updated/deleted
ij> DROP VIEW VW03_GAN_PER_PROD_PESO_RF;
0 rows inserted/updated/deleted
ij> DROP VIEW VW03_GAN_PER_PROD_PESO_RV;
0 rows inserted/updated/deleted
ij> DROP VIEW VW03_GAN_PER_PROD_PESO_GLOBAL;
0 rows inserted/updated/deleted
ij> DROP VIEW VW02_GAN_PER_PROD_ORO;
0 rows inserted/updated/deleted
ij> DROP VIEW VW02_GAN_PER_PROD_RF;
0 rows inserted/updated/deleted
ij> DROP VIEW VW02_GAN_PER_PROD_RV;
0 rows inserted/updated/deleted
ij> DROP VIEW VW02_GAN_PER_PROD_GLOBAL;
0 rows inserted/updated/deleted
ij> DROP VIEW VW01_MOVIMIENTOS_PRODUCTOS;
0 rows inserted/updated/deleted
ij> DROP TABLE TB02_MOVIMIENTOS;
0 rows inserted/updated/deleted
ij> DROP TABLE TB02_PRODUCTOS_VAR;
0 rows inserted/updated/deleted
ij> DROP TABLE TB02_PRODUCTOS;
0 rows inserted/updated/deleted
ij> DROP TABLE TB01_MERCADO;
0 rows inserted/updated/deleted
ij> DROP TABLE TB01_COMERCIALIZADOR;
0 rows inserted/updated/deleted
ij> DROP TABLE TB01_COMPRA_VENTA;
0 rows inserted/updated/deleted
ij> DROP TABLE TB01_USO_INGRESOS;
0 rows inserted/updated/deleted
ij> DROP TABLE TB01_MONEDA;
0 rows inserted/updated/deleted
ij> DROP TABLE TB01_SUBTIPO_ACTIVO;
0 rows inserted/updated/deleted
ij> DROP TABLE TB01_TIPO_ACTIVO;
0 rows inserted/updated/deleted
ij> DROP TABLE TB01_INSTRUMENTO;
0 rows inserted/updated/deleted
ij> DROP TABLE TB01_PROVEEDOR;
0 rows inserted/updated/deleted
ij> DROP TABLE TB00_EFECTIVO;
0 rows inserted/updated/deleted
ij> --
--
--
CREATE TABLE TB00_EFECTIVO
(
	NOMBRE_CUENTA VARCHAR(50) NOT NULL, 
	LIQUIDO DECIMAL(12, 4) NOT NULL, 
	INMOVILIZADO DECIMAL(12, 4) NOT NULL
);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB00_EFECTIVO ADD CONSTRAINT TB00_EFECTIVO_NOMBRE_CUENTA_PK Primary Key (NOMBRE_CUENTA);
0 rows inserted/updated/deleted
ij> --
--
--
INSERT INTO TB00_EFECTIVO (NOMBRE_CUENTA, LIQUIDO, INMOVILIZADO) VALUES ('ING Sin Nomina', 					1719.95,		0);
1 row inserted/updated/deleted
ij> INSERT INTO TB00_EFECTIVO (NOMBRE_CUENTA, LIQUIDO, INMOVILIZADO) VALUES ('ING Naranja', 					0,				0);
1 row inserted/updated/deleted
ij> INSERT INTO TB00_EFECTIVO (NOMBRE_CUENTA, LIQUIDO, INMOVILIZADO) VALUES ('Bankinter Nomina', 				6713.12,		0);
1 row inserted/updated/deleted
ij> INSERT INTO TB00_EFECTIVO (NOMBRE_CUENTA, LIQUIDO, INMOVILIZADO) VALUES ('EVO Cuenta Corriente', 			111.11,			0);
1 row inserted/updated/deleted
ij> INSERT INTO TB00_EFECTIVO (NOMBRE_CUENTA, LIQUIDO, INMOVILIZADO) VALUES ('EVO Deposito', 					0,				0);
1 row inserted/updated/deleted
ij> INSERT INTO TB00_EFECTIVO (NOMBRE_CUENTA, LIQUIDO, INMOVILIZADO) VALUES ('NN Cuenta Ahorro', 				10000.26,		0);
1 row inserted/updated/deleted
ij> INSERT INTO TB00_EFECTIVO (NOMBRE_CUENTA, LIQUIDO, INMOVILIZADO) VALUES ('Ticket Restaurant', 				0,				256.99);
1 row inserted/updated/deleted
ij> INSERT INTO TB00_EFECTIVO (NOMBRE_CUENTA, LIQUIDO, INMOVILIZADO) VALUES ('Openbank Familiar', 				0,				964.04);
1 row inserted/updated/deleted
ij> INSERT INTO TB00_EFECTIVO (NOMBRE_CUENTA, LIQUIDO, INMOVILIZADO) VALUES ('Openbank Fondos', 				0,				0);
1 row inserted/updated/deleted
ij> INSERT INTO TB00_EFECTIVO (NOMBRE_CUENTA, LIQUIDO, INMOVILIZADO) VALUES ('Myinvestor Cuenta Corriente', 	15009.22,		0);
1 row inserted/updated/deleted
ij> INSERT INTO TB00_EFECTIVO (NOMBRE_CUENTA, LIQUIDO, INMOVILIZADO) VALUES ('Selfbank Fondos', 				0,				0);
1 row inserted/updated/deleted
ij> INSERT INTO TB00_EFECTIVO (NOMBRE_CUENTA, LIQUIDO, INMOVILIZADO) VALUES ('Selfbank Bolsa Sin Custodia', 	0,				0);
1 row inserted/updated/deleted
ij> INSERT INTO TB00_EFECTIVO (NOMBRE_CUENTA, LIQUIDO, INMOVILIZADO) VALUES ('ClickTrade', 						0,				0);
1 row inserted/updated/deleted
ij> INSERT INTO TB00_EFECTIVO (NOMBRE_CUENTA, LIQUIDO, INMOVILIZADO) VALUES ('Degiro jotasumin', 				3.89,			3.61);
1 row inserted/updated/deleted
ij> INSERT INTO TB00_EFECTIVO (NOMBRE_CUENTA, LIQUIDO, INMOVILIZADO) VALUES ('Degiro jsubiasm', 				0,				0);
1 row inserted/updated/deleted
ij> --
--
--
CREATE TABLE TB01_COMPRA_VENTA
(
	CLAVE INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
	VALOR VARCHAR(10) NOT NULL
);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB01_COMPRA_VENTA ADD CONSTRAINT TB01_COMPRA_VENTA_VALOR_PK Primary Key (VALOR);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB01_COMPRA_VENTA ADD CONSTRAINT TB01_COMPRA_VENTA_CLAVE_UNQ Unique (CLAVE);
0 rows inserted/updated/deleted
ij> --
--
--
INSERT INTO TB01_COMPRA_VENTA (VALOR) VALUES ('Compra');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_COMPRA_VENTA (VALOR) VALUES ('Venta');
1 row inserted/updated/deleted
ij> --
--
--
CREATE TABLE TB01_TIPO_ACTIVO
(
	CLAVE INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
	VALOR VARCHAR(20) NOT NULL
);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB01_TIPO_ACTIVO ADD CONSTRAINT TB01_TIPO_ACTIVO_VALOR_PK Primary Key (VALOR);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB01_TIPO_ACTIVO ADD CONSTRAINT TB01_TIPO_ACTIVO_CLAVE_UNQ Unique (CLAVE);
0 rows inserted/updated/deleted
ij> --
--
--
INSERT INTO TB01_TIPO_ACTIVO (VALOR) VALUES ('Renta Variable');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_TIPO_ACTIVO (VALOR) VALUES ('Renta Fija');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_TIPO_ACTIVO (VALOR) VALUES ('Oro');
1 row inserted/updated/deleted
ij> --
--
--
CREATE TABLE TB01_SUBTIPO_ACTIVO
(
	CLAVE INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
	VALOR VARCHAR(20) NOT NULL
);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB01_SUBTIPO_ACTIVO ADD CONSTRAINT TB01_SUBTIPO_ACTIVO_VALOR_PK Primary Key (VALOR);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB01_SUBTIPO_ACTIVO ADD CONSTRAINT TB01_SUBTIPO_ACTIVO_CLAVE_UNQ Unique (CLAVE);
0 rows inserted/updated/deleted
ij> --
--
--
INSERT INTO TB01_SUBTIPO_ACTIVO (VALOR) VALUES ('Oro Invesco');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_SUBTIPO_ACTIVO (VALOR) VALUES ('Oro WisdomTree');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_SUBTIPO_ACTIVO (VALOR) VALUES ('Oro XetraGold');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_SUBTIPO_ACTIVO (VALOR) VALUES ('RF Alemania LP');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_SUBTIPO_ACTIVO (VALOR) VALUES ('RF Europa BLI');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_SUBTIPO_ACTIVO (VALOR) VALUES ('RF Europa LP');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_SUBTIPO_ACTIVO (VALOR) VALUES ('RF Europa MP');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_SUBTIPO_ACTIVO (VALOR) VALUES ('RF Global MP');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_SUBTIPO_ACTIVO (VALOR) VALUES ('RF USA LP');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_SUBTIPO_ACTIVO (VALOR) VALUES ('RV Emergente');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_SUBTIPO_ACTIVO (VALOR) VALUES ('RV Europa');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_SUBTIPO_ACTIVO (VALOR) VALUES ('RV Global');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_SUBTIPO_ACTIVO (VALOR) VALUES ('RV Japon');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_SUBTIPO_ACTIVO (VALOR) VALUES ('RV Norteamerica');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_SUBTIPO_ACTIVO (VALOR) VALUES ('RV Pacifico');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_SUBTIPO_ACTIVO (VALOR) VALUES ('RV REITs');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_SUBTIPO_ACTIVO (VALOR) VALUES ('RV USA');
1 row inserted/updated/deleted
ij> --
--
--
CREATE TABLE TB01_MONEDA
(
	CLAVE INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
	VALOR VARCHAR(20) NOT NULL
);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB01_MONEDA ADD CONSTRAINT TB01_MONEDA_VALOR_PK Primary Key (VALOR);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB01_MONEDA ADD CONSTRAINT TB01_MONEDA_CLAVE_UNQ Unique (CLAVE);
0 rows inserted/updated/deleted
ij> --
--
--
INSERT INTO TB01_MONEDA (VALOR) VALUES ('EUR');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_MONEDA (VALOR) VALUES ('EUR (Hdg)');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_MONEDA (VALOR) VALUES ('EUR (No Hdg)');
1 row inserted/updated/deleted
ij> --
--
--
CREATE TABLE TB01_INSTRUMENTO
(
	CLAVE INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
	VALOR VARCHAR(20) NOT NULL
);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB01_INSTRUMENTO ADD CONSTRAINT TB01_INSTRUMENTO_VALOR_PK Primary Key (VALOR);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB01_INSTRUMENTO ADD CONSTRAINT TB01_INSTRUMENTO_CLAVE_UNQ Unique (CLAVE);
0 rows inserted/updated/deleted
ij> --
--
--
INSERT INTO TB01_INSTRUMENTO (VALOR) VALUES ('Fondo');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_INSTRUMENTO (VALOR) VALUES ('ETF');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_INSTRUMENTO (VALOR) VALUES ('ETC');
1 row inserted/updated/deleted
ij> --
--
--
CREATE TABLE TB01_USO_INGRESOS
(
	CLAVE INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
	VALOR VARCHAR(20) NOT NULL
);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB01_USO_INGRESOS ADD CONSTRAINT TB01_USO_INGRESOS_VALOR_PK Primary Key (VALOR);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB01_USO_INGRESOS ADD CONSTRAINT TB01_USO_INGRESOS_CLAVE_UNQ Unique (CLAVE);
0 rows inserted/updated/deleted
ij> --
--
--
INSERT INTO TB01_USO_INGRESOS (VALOR) VALUES ('Acumulacion');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_USO_INGRESOS (VALOR) VALUES ('Distribucion');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_USO_INGRESOS (VALOR) VALUES ('N/A');
1 row inserted/updated/deleted
ij> --
--
--
CREATE TABLE TB01_MERCADO
(
	CLAVE INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
	VALOR VARCHAR(20) NOT NULL
);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB01_MERCADO ADD CONSTRAINT TB01_MERCADO_VALOR_PK Primary Key (VALOR);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB01_MERCADO ADD CONSTRAINT TB01_MERCADO_CLAVE_UNQ Unique (CLAVE);
0 rows inserted/updated/deleted
ij> --
--
--
INSERT INTO TB01_MERCADO (VALOR) VALUES ('Londres');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_MERCADO (VALOR) VALUES ('Xetra');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_MERCADO (VALOR) VALUES ('N/A');
1 row inserted/updated/deleted
ij> --
--
--
CREATE TABLE TB01_COMERCIALIZADOR
(
	CLAVE INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
	VALOR VARCHAR(20) NOT NULL
);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB01_COMERCIALIZADOR ADD CONSTRAINT TB01_COMERCIALIZADOR_VALOR_PK Primary Key (VALOR);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB01_COMERCIALIZADOR ADD CONSTRAINT TB01_COMERCIALIZADOR_CLAVE_UNQ Unique (CLAVE);
0 rows inserted/updated/deleted
ij> --
--
--
INSERT INTO TB01_COMERCIALIZADOR (VALOR) VALUES ('Openbank');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_COMERCIALIZADOR (VALOR) VALUES ('MyInvestor');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_COMERCIALIZADOR (VALOR) VALUES ('SelfBank');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_COMERCIALIZADOR (VALOR) VALUES ('Degiro');
1 row inserted/updated/deleted
ij> --
--
--
CREATE TABLE TB01_PROVEEDOR
(
	CLAVE INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
	VALOR VARCHAR(20) NOT NULL
);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB01_PROVEEDOR ADD CONSTRAINT TB01_PROVEEDOR_VALOR_PK Primary Key (VALOR);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB01_PROVEEDOR ADD CONSTRAINT TB01_PROVEEDOR_CLAVE_UNQ Unique (CLAVE);
0 rows inserted/updated/deleted
ij> --
--
--
INSERT INTO TB01_PROVEEDOR (VALOR) VALUES ('Amundi');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_PROVEEDOR (VALOR) VALUES ('Deka');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_PROVEEDOR (VALOR) VALUES ('Invesco');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_PROVEEDOR (VALOR) VALUES ('Lyxor');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_PROVEEDOR (VALOR) VALUES ('Vanguard');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_PROVEEDOR (VALOR) VALUES ('WisdomTree');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_PROVEEDOR (VALOR) VALUES ('DBC GmbH');
1 row inserted/updated/deleted
ij> INSERT INTO TB01_PROVEEDOR (VALOR) VALUES ('iShares');
1 row inserted/updated/deleted
ij> --
--
--
CREATE TABLE TB02_PRODUCTOS
(
	IDENTIFICADOR VARCHAR(20) NOT NULL,
	NOMBRE VARCHAR(75) NOT NULL,
	PROVEEDOR VARCHAR(20) NOT NULL,
	INSTRUMENTO VARCHAR(20) NOT NULL,
	TIPO_ACTIVO VARCHAR(20) NOT NULL,
	SUBTIPO_ACTIVO VARCHAR(20) NOT NULL,
	MONEDA VARCHAR(20) NOT NULL,
	USO_INGRESOS VARCHAR(20) NOT NULL
);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB02_PRODUCTOS ADD CONSTRAINT TB02_PRODUCTOS_IDENTIFICADOR_PK Primary Key (IDENTIFICADOR);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB02_PRODUCTOS ADD CONSTRAINT TB02_PRODUCTOS_NOMBRE_UNQ Unique (NOMBRE);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB02_PRODUCTOS ADD CONSTRAINT TB02_PRODUCTOS_PROVEEDOR_FK Foreign Key (PROVEEDOR) REFERENCES TB01_PROVEEDOR (VALOR);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB02_PRODUCTOS ADD CONSTRAINT TB02_PRODUCTOS_INSTRUMENTO_FK Foreign Key (INSTRUMENTO) REFERENCES TB01_INSTRUMENTO (VALOR);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB02_PRODUCTOS ADD CONSTRAINT TB02_PRODUCTOS_TIPO_ACTIVO_FK Foreign Key (TIPO_ACTIVO) REFERENCES TB01_TIPO_ACTIVO (VALOR);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB02_PRODUCTOS ADD CONSTRAINT TB02_PRODUCTOS_SUBTIPO_ACTIVO_FK Foreign Key (SUBTIPO_ACTIVO) REFERENCES TB01_SUBTIPO_ACTIVO (VALOR);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB02_PRODUCTOS ADD CONSTRAINT TB02_PRODUCTOS_MONEDA_FK Foreign Key (MONEDA) REFERENCES TB01_MONEDA (VALOR);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB02_PRODUCTOS ADD CONSTRAINT TB02_PRODUCTOS_USO_INGRESOS_FK Foreign Key (USO_INGRESOS) REFERENCES TB01_USO_INGRESOS (VALOR);
0 rows inserted/updated/deleted
ij> --
--
--
INSERT INTO TB02_PRODUCTOS (IDENTIFICADOR, NOMBRE, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS) VALUES ('DE000A0D8Q31','iShares eb.rexx GovtGer 10.5+yr (DE)','iShares','ETF','Renta Fija','RF Alemania LP','EUR','Distribucion');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS (IDENTIFICADOR, NOMBRE, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS) VALUES ('DE000A0S9GB0','DBC GmbH Xetra-Gold EUR','DBC GmbH','ETC','Oro','Oro XetraGold','EUR (No Hdg)','N/A');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS (IDENTIFICADOR, NOMBRE, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS) VALUES ('DE000A1DCTL3','WisdomTree Physical Swiss Gold ETC EUR','WisdomTree','ETC','Oro','Oro WisdomTree','EUR (No Hdg)','N/A');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS (IDENTIFICADOR, NOMBRE, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS) VALUES ('DE000ETFL219','Deka Dt. Boerse EUROGOV Ger 10+ ETF','Deka','ETF','Renta Fija','RF Alemania LP','EUR','Distribucion');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS (IDENTIFICADOR, NOMBRE, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS) VALUES ('IE0007201266','Vanguard Pac ex-Japan Stk Idx EUR Acc','Vanguard','Fondo','Renta Variable','RV Pacifico','EUR (No Hdg)','Acumulacion');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS (IDENTIFICADOR, NOMBRE, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS) VALUES ('IE0007281425','Vanguard Japan Stock Index Inv EUR Acc','Vanguard','Fondo','Renta Variable','RV Japon','EUR (No Hdg)','Acumulacion');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS (IDENTIFICADOR, NOMBRE, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS) VALUES ('IE0007286036','Vanguard Jpn Stk Idx Eur Acc','Vanguard','Fondo','Renta Variable','RV Japon','EUR (No Hdg)','Acumulacion');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS (IDENTIFICADOR, NOMBRE, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS) VALUES ('IE0007987690','Vanguard European Stock Idx Inv EUR Acc','Vanguard','Fondo','Renta Variable','RV Europa','EUR (No Hdg)','Acumulacion');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS (IDENTIFICADOR, NOMBRE, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS) VALUES ('IE0007987708','Vanguard European Stk Idx Eur Acc','Vanguard','Fondo','Renta Variable','RV Europa','EUR (No Hdg)','Acumulacion');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS (IDENTIFICADOR, NOMBRE, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS) VALUES ('IE0031786142','Vanguard Emerg Mkts Stk Idx Inv EUR Acc','Vanguard','Fondo','Renta Variable','RV Emergente','EUR (No Hdg)','Acumulacion');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS (IDENTIFICADOR, NOMBRE, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS) VALUES ('IE0031786696','Vanguard Em Mkts Stk Idx Eur Acc','Vanguard','Fondo','Renta Variable','RV Emergente','EUR (No Hdg)','Acumulacion');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS (IDENTIFICADOR, NOMBRE, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS) VALUES ('IE0032126645','Vanguard US 500 Stk Idx Eur Acc','Vanguard','Fondo','Renta Variable','RV USA','EUR (No Hdg)','Acumulacion');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS (IDENTIFICADOR, NOMBRE, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS) VALUES ('IE0032620787','Vanguard US 500 Stock Index Inv EUR Acc','Vanguard','Fondo','Renta Variable','RV USA','EUR (No Hdg)','Acumulacion');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS (IDENTIFICADOR, NOMBRE, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS) VALUES ('IE00B04GQR24','Vanguard Eurozone InflLnkd Bd Idx Eur Acc','Vanguard','Fondo','Renta Fija','RF Europa BLI','EUR','Acumulacion');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS (IDENTIFICADOR, NOMBRE, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS) VALUES ('IE00B246KL88','Vanguard 20+ Yr Eur Trs Idx Eur Acc','Vanguard','Fondo','Renta Fija','RF Europa LP','EUR','Acumulacion');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS (IDENTIFICADOR, NOMBRE, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS) VALUES ('IE00B4L5YX21','iShares Core MSCI Japan IMI ETF USD Acc EUR','iShares','ETF','Renta Variable','RV Japon','EUR (No Hdg)','Acumulacion');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS (IDENTIFICADOR, NOMBRE, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS) VALUES ('IE00B4WXT857','iShares Eur GovInfLkd BdIdx(IE) InstlAcc Eur','iShares','Fondo','Renta Fija','RF Europa BLI','EUR','Acumulacion');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS (IDENTIFICADOR, NOMBRE, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS) VALUES ('IE00B4XCK338','iShares UltraHQ EurGovtBdIdx(IE) InstAcc Eur','iShares','Fondo','Renta Fija','RF Europa MP','EUR','Acumulacion');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS (IDENTIFICADOR, NOMBRE, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS) VALUES ('IE00B579F325','Invesco Physical Gold ETC EUR','Invesco','ETC','Oro','Oro Invesco','EUR (No Hdg)','N/A');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS (IDENTIFICADOR, NOMBRE, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS) VALUES ('IE00B5BMR087','iShares Core SP 500 ETF USD Acc EUR','iShares','ETF','Renta Variable','RV USA','EUR (No Hdg)','Acumulacion');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS (IDENTIFICADOR, NOMBRE, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS) VALUES ('IE00B83YJG36','iShares Dev Rl Ett Idx (IE) Instl Acc EUR','iShares','Fondo','Renta Variable','RV REITs','EUR (No Hdg)','Acumulacion');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS (IDENTIFICADOR, NOMBRE, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS) VALUES ('IE00BD8PGZ49','iShares US Treasury Bd 20+y ETF EUR HDist','iShares','ETF','Renta Fija','RF USA LP','EUR (Hdg)','Distribucion');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS (IDENTIFICADOR, NOMBRE, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS) VALUES ('IE00BDRK7R97','iShares Pacific Index (IE) D Acc EUR','iShares','Fondo','Renta Variable','RV Pacifico','EUR (No Hdg)','Acumulacion');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS (IDENTIFICADOR, NOMBRE, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS) VALUES ('IE00BK5BQT80','Vanguard FTSE All-World ETF USD Acc EUR','Vanguard','ETF','Renta Variable','RV Global','EUR (No Hdg)','Acumulacion');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS (IDENTIFICADOR, NOMBRE, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS) VALUES ('IE00BK5BQZ41','Vanguard FTSE Dev AsiaPac exJpn ETF USD Acc EUR','Vanguard','ETF','Renta Variable','RV Pacifico','EUR (No Hdg)','Acumulacion');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS (IDENTIFICADOR, NOMBRE, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS) VALUES ('IE00BK5BR733','Vanguard FTSE Emerg Markets ETF USD Acc EUR','Vanguard','ETF','Renta Variable','RV Emergente','EUR (No Hdg)','Acumulacion');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS (IDENTIFICADOR, NOMBRE, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS) VALUES ('IE00BSKRJX20','iShares Euro Govt Bond 20y TgtDur ETF Eur Dist EUR','iShares','ETF','Renta Fija','RF Europa LP','EUR','Distribucion');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS (IDENTIFICADOR, NOMBRE, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS) VALUES ('LU0389812933','Amundi IS JP Morgan GBI Glbl Gvs AHE-C','Amundi','Fondo','Renta Fija','RF Global MP','EUR (Hdg)','Acumulacion');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS (IDENTIFICADOR, NOMBRE, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS) VALUES ('LU0908500753','Lyxor Core STOXX Europe 600(DR) ETF Acc EUR','Lyxor','ETF','Renta Variable','RV Europa','EUR (No Hdg)','Acumulacion');
1 row inserted/updated/deleted
ij> --
--
--
CREATE TABLE TB02_PRODUCTOS_VAR
(
	PRODUCTO_ID VARCHAR(20) NOT NULL,
	VALOR_TITULO DECIMAL(12, 4),
	FECHA_VALOR DATE,
	TER DECIMAL(12, 4),
	FECHA_TER DATE,	
	ULTIMA_ACTUALIZACION TIMESTAMP,
	URL_SCRAPING VARCHAR(150) NOT NULL
);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB02_PRODUCTOS_VAR ADD CONSTRAINT TB02_PRODUCTOS_VAR_PRODUCTO_ID_PK Primary Key (PRODUCTO_ID);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB02_PRODUCTOS_VAR ADD CONSTRAINT TB02_PRODUCTOS_VAR_PRODUCTO_ID_FK Foreign Key (PRODUCTO_ID) REFERENCES TB02_PRODUCTOS (IDENTIFICADOR);
0 rows inserted/updated/deleted
ij> --
--
--
INSERT INTO TB02_PRODUCTOS_VAR (PRODUCTO_ID, VALOR_TITULO, FECHA_VALOR, TER, FECHA_TER, ULTIMA_ACTUALIZACION, URL_SCRAPING) VALUES ('DE000A0D8Q31', 207.4, '2021-01-26', 0.16, '2021-02-05', CURRENT_TIMESTAMP, 'https://www.morningstar.es/es/etf/snapshot/p_snapshot.aspx?id=0P00001NR4');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS_VAR (PRODUCTO_ID, VALOR_TITULO, FECHA_VALOR, TER, FECHA_TER, ULTIMA_ACTUALIZACION, URL_SCRAPING) VALUES ('DE000A0S9GB0', 49.188, '2021-02-02', 0.15, '1999-12-31', CURRENT_TIMESTAMP, 'https://www.morningstar.es/es/etf/snapshot/p_snapshot.aspx?id=0P0000M7DL');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS_VAR (PRODUCTO_ID, VALOR_TITULO, FECHA_VALOR, TER, FECHA_TER, ULTIMA_ACTUALIZACION, URL_SCRAPING) VALUES ('DE000A1DCTL3', 147.27, '2021-02-02', 0.15, '1999-12-31', CURRENT_TIMESTAMP, 'https://www.morningstar.es/es/etf/snapshot/p_snapshot.aspx?id=0P0000NA52');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS_VAR (PRODUCTO_ID, VALOR_TITULO, FECHA_VALOR, TER, FECHA_TER, ULTIMA_ACTUALIZACION, URL_SCRAPING) VALUES ('DE000ETFL219', 176.97, '2021-01-26', 0.15, '2020-06-30', CURRENT_TIMESTAMP, 'https://www.morningstar.es/es/etf/snapshot/p_snapshot.aspx?id=0P0000JNSO');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS_VAR (PRODUCTO_ID, VALOR_TITULO, FECHA_VALOR, TER, FECHA_TER, ULTIMA_ACTUALIZACION, URL_SCRAPING) VALUES ('IE0007201266', 244.0309, '2021-02-02', 0.16, '2020-06-19', CURRENT_TIMESTAMP, 'https://www.morningstar.es/es/funds/snapshot/p_snapshot.aspx?id=F00000T1I9');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS_VAR (PRODUCTO_ID, VALOR_TITULO, FECHA_VALOR, TER, FECHA_TER, ULTIMA_ACTUALIZACION, URL_SCRAPING) VALUES ('IE0007281425', 229.97, '2021-01-26', 0.16, '2020-02-18', CURRENT_TIMESTAMP, 'https://www.morningstar.es/es/funds/snapshot/p_snapshot.aspx?id=F0GBR061V3');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS_VAR (PRODUCTO_ID, VALOR_TITULO, FECHA_VALOR, TER, FECHA_TER, ULTIMA_ACTUALIZACION, URL_SCRAPING) VALUES ('IE0007286036', 229.6455, '2021-02-02', 0.16, '2020-06-19', CURRENT_TIMESTAMP, 'https://www.morningstar.es/es/funds/snapshot/p_snapshot.aspx?id=F0GBR061XN');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS_VAR (PRODUCTO_ID, VALOR_TITULO, FECHA_VALOR, TER, FECHA_TER, ULTIMA_ACTUALIZACION, URL_SCRAPING) VALUES ('IE0007987690', 22.14, '2021-01-26', 0.12, '2020-02-18', CURRENT_TIMESTAMP, 'https://www.morningstar.es/es/funds/snapshot/p_snapshot.aspx?id=F0GBR04SKF');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS_VAR (PRODUCTO_ID, VALOR_TITULO, FECHA_VALOR, TER, FECHA_TER, ULTIMA_ACTUALIZACION, URL_SCRAPING) VALUES ('IE0007987708', 22.4465, '2021-02-02', 0.12, '2020-06-19', CURRENT_TIMESTAMP, 'https://www.morningstar.es/es/funds/snapshot/p_snapshot.aspx?id=F0GBR04SGM');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS_VAR (PRODUCTO_ID, VALOR_TITULO, FECHA_VALOR, TER, FECHA_TER, ULTIMA_ACTUALIZACION, URL_SCRAPING) VALUES ('IE0031786142', 212.2306, '2021-02-02', 0.23, '2020-02-18', CURRENT_TIMESTAMP, 'https://www.morningstar.es/es/funds/snapshot/p_snapshot.aspx?id=F0GBR06TSA');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS_VAR (PRODUCTO_ID, VALOR_TITULO, FECHA_VALOR, TER, FECHA_TER, ULTIMA_ACTUALIZACION, URL_SCRAPING) VALUES ('IE0031786696', 212.2, '2021-01-26', 0.23, '2020-06-19', CURRENT_TIMESTAMP, 'https://www.morningstar.es/es/funds/snapshot/p_snapshot.aspx?id=F00000T1HU');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS_VAR (PRODUCTO_ID, VALOR_TITULO, FECHA_VALOR, TER, FECHA_TER, ULTIMA_ACTUALIZACION, URL_SCRAPING) VALUES ('IE0032126645', 36.8808, '2021-02-02', 0.10, '2020-06-19', CURRENT_TIMESTAMP, 'https://www.morningstar.es/es/funds/snapshot/p_snapshot.aspx?id=F0GBR04UOL');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS_VAR (PRODUCTO_ID, VALOR_TITULO, FECHA_VALOR, TER, FECHA_TER, ULTIMA_ACTUALIZACION, URL_SCRAPING) VALUES ('IE0032620787', 35.94, '2021-01-26', 0.10, '2020-02-18', CURRENT_TIMESTAMP, 'https://www.morningstar.es/es/funds/snapshot/p_snapshot.aspx?id=F0GBR04G0F');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS_VAR (PRODUCTO_ID, VALOR_TITULO, FECHA_VALOR, TER, FECHA_TER, ULTIMA_ACTUALIZACION, URL_SCRAPING) VALUES ('IE00B04GQR24', 133.82, '2021-01-26', 0.12, '2020-07-15', CURRENT_TIMESTAMP, 'https://www.morningstar.es/es/funds/snapshot/p_snapshot.aspx?id=F0GBR05WKI');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS_VAR (PRODUCTO_ID, VALOR_TITULO, FECHA_VALOR, TER, FECHA_TER, ULTIMA_ACTUALIZACION, URL_SCRAPING) VALUES ('IE00B246KL88', 264.7174, '2021-02-02', 0.16, '2020-06-19', CURRENT_TIMESTAMP, 'https://www.morningstar.es/es/funds/snapshot/p_snapshot.aspx?id=F000001GFI');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS_VAR (PRODUCTO_ID, VALOR_TITULO, FECHA_VALOR, TER, FECHA_TER, ULTIMA_ACTUALIZACION, URL_SCRAPING) VALUES ('IE00B4L5YX21', 42.88, '2021-01-26', 0.15, '2021-01-27', CURRENT_TIMESTAMP, 'https://www.morningstar.es/es/etf/snapshot/p_snapshot.aspx?id=0P0000MEHV');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS_VAR (PRODUCTO_ID, VALOR_TITULO, FECHA_VALOR, TER, FECHA_TER, ULTIMA_ACTUALIZACION, URL_SCRAPING) VALUES ('IE00B4WXT857', 13.816, '2021-02-02', 0.13, '2020-10-29', CURRENT_TIMESTAMP, 'https://www.morningstar.es/es/funds/snapshot/p_snapshot.aspx?id=F00000PEDX');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS_VAR (PRODUCTO_ID, VALOR_TITULO, FECHA_VALOR, TER, FECHA_TER, ULTIMA_ACTUALIZACION, URL_SCRAPING) VALUES ('IE00B4XCK338', 13.207, '2021-02-02', 0.13, '2020-10-29', CURRENT_TIMESTAMP, 'https://www.morningstar.es/es/funds/snapshot/p_snapshot.aspx?id=F00000OEDJ');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS_VAR (PRODUCTO_ID, VALOR_TITULO, FECHA_VALOR, TER, FECHA_TER, ULTIMA_ACTUALIZACION, URL_SCRAPING) VALUES ('IE00B579F325', 147.99, '2021-02-02', 0.19, '2020-02-28', CURRENT_TIMESTAMP, 'https://www.morningstar.es/es/etf/snapshot/p_snapshot.aspx?id=0P0000WGWI');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS_VAR (PRODUCTO_ID, VALOR_TITULO, FECHA_VALOR, TER, FECHA_TER, ULTIMA_ACTUALIZACION, URL_SCRAPING) VALUES ('IE00B5BMR087', 319.94, '2021-01-26', 0.07, '2021-02-03', CURRENT_TIMESTAMP, 'https://www.morningstar.es/es/etf/snapshot/p_snapshot.aspx?id=0P0000OO21');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS_VAR (PRODUCTO_ID, VALOR_TITULO, FECHA_VALOR, TER, FECHA_TER, ULTIMA_ACTUALIZACION, URL_SCRAPING) VALUES ('IE00B83YJG36', 15.56, '2021-02-19', 0.22, '2021-02-12', CURRENT_TIMESTAMP, 'https://www.morningstar.es/es/funds/snapshot/p_snapshot.aspx?id=F00000PJME');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS_VAR (PRODUCTO_ID, VALOR_TITULO, FECHA_VALOR, TER, FECHA_TER, ULTIMA_ACTUALIZACION, URL_SCRAPING) VALUES ('IE00BD8PGZ49', 5.36, '2021-02-17', 0.10, '2021-02-03', CURRENT_TIMESTAMP, 'https://www.morningstar.es/es/etf/snapshot/p_snapshot.aspx?id=0P0001BOL6');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS_VAR (PRODUCTO_ID, VALOR_TITULO, FECHA_VALOR, TER, FECHA_TER, ULTIMA_ACTUALIZACION, URL_SCRAPING) VALUES ('IE00BDRK7R97', 12.38, '2021-01-25', 0.15, '2020-12-01', CURRENT_TIMESTAMP, 'https://www.morningstar.es/es/funds/snapshot/p_snapshot.aspx?id=F00000Z2S4');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS_VAR (PRODUCTO_ID, VALOR_TITULO, FECHA_VALOR, TER, FECHA_TER, ULTIMA_ACTUALIZACION, URL_SCRAPING) VALUES ('IE00BK5BQT80', 84.89, '2021-01-26', 0.22, '2020-06-30', CURRENT_TIMESTAMP, 'https://www.morningstar.es/es/etf/snapshot/p_snapshot.aspx?id=0P0001I3S0');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS_VAR (PRODUCTO_ID, VALOR_TITULO, FECHA_VALOR, TER, FECHA_TER, ULTIMA_ACTUALIZACION, URL_SCRAPING) VALUES ('IE00BK5BQZ41', 27.46, '2021-01-26', 0.15, '2020-06-30', CURRENT_TIMESTAMP, 'https://www.morningstar.es/es/etf/snapshot/p_snapshot.aspx?id=0P0001IHVY');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS_VAR (PRODUCTO_ID, VALOR_TITULO, FECHA_VALOR, TER, FECHA_TER, ULTIMA_ACTUALIZACION, URL_SCRAPING) VALUES ('IE00BK5BR733', 56.09, '2021-01-26', 0.22, '2020-06-30', CURRENT_TIMESTAMP, 'https://www.morningstar.es/es/etf/snapshot/p_snapshot.aspx?id=0P0001IHW1');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS_VAR (PRODUCTO_ID, VALOR_TITULO, FECHA_VALOR, TER, FECHA_TER, ULTIMA_ACTUALIZACION, URL_SCRAPING) VALUES ('IE00BSKRJX20', 6.53, '2021-01-26', 0.15, '2021-02-03', CURRENT_TIMESTAMP, 'https://www.morningstar.es/es/etf/snapshot/p_snapshot.aspx?id=0P00015OCO');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS_VAR (PRODUCTO_ID, VALOR_TITULO, FECHA_VALOR, TER, FECHA_TER, ULTIMA_ACTUALIZACION, URL_SCRAPING) VALUES ('LU0389812933', 144.48, '2021-01-26', 0.35, '2020-02-03', CURRENT_TIMESTAMP, 'https://www.morningstar.es/es/funds/snapshot/p_snapshot.aspx?id=F000002871');
1 row inserted/updated/deleted
ij> INSERT INTO TB02_PRODUCTOS_VAR (PRODUCTO_ID, VALOR_TITULO, FECHA_VALOR, TER, FECHA_TER, ULTIMA_ACTUALIZACION, URL_SCRAPING) VALUES ('LU0908500753', 171.12, '2021-01-26', 0.07, '2020-08-14', CURRENT_TIMESTAMP, 'https://www.morningstar.es/es/etf/snapshot/p_snapshot.aspx?id=0P0001BMZU');
1 row inserted/updated/deleted
ij> --
--
--
CREATE TABLE TB02_MOVIMIENTOS
(
	MOVIMIENTO_ID INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
	PRODUCTO_ID VARCHAR(20) NOT NULL,
	COMPRA_VENTA VARCHAR(10) NOT NULL,
	FECHA DATE NOT NULL,
	NUMERO_TITULOS DECIMAL(12, 4) NOT NULL,
	PRECIO_TITULO DECIMAL(12, 4) NOT NULL,	
	COMISION DECIMAL(12, 4) NOT NULL,	
	TOTAL DECIMAL(12, 4) NOT NULL,
	COMERCIALIZADOR VARCHAR(20) NOT NULL,
	MERCADO VARCHAR(20) NOT NULL,
	SIMULADO BOOLEAN
);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB02_MOVIMIENTOS ADD CONSTRAINT TB02_MOVIMIENTOS_MOVIMIENTO_ID_PK Primary Key (MOVIMIENTO_ID);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB02_MOVIMIENTOS ADD CONSTRAINT TB02_MOVIMIENTOS_PRODUCTO_ID_FK Foreign Key (PRODUCTO_ID) REFERENCES TB02_PRODUCTOS (IDENTIFICADOR);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB02_MOVIMIENTOS ADD CONSTRAINT TB02_MOVIMIENTOS_COMPRA_VENTA_FK Foreign Key (COMPRA_VENTA) REFERENCES TB01_COMPRA_VENTA (VALOR);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB02_MOVIMIENTOS ADD CONSTRAINT TB02_MOVIMIENTOS_COMERCIALIZADOR_FK Foreign Key (COMERCIALIZADOR) REFERENCES TB01_COMERCIALIZADOR (VALOR);
0 rows inserted/updated/deleted
ij> ALTER TABLE TB02_MOVIMIENTOS ADD CONSTRAINT TB02_MOVIMIENTOS_MERCADO_FK Foreign Key (MERCADO) REFERENCES TB01_MERCADO (VALOR);
0 rows inserted/updated/deleted
ij> --
-- SELECT 'INSERT INTO TB02_MOVIMIENTOS (PRODUCTO_ID,COMPRA_VENTA,FECHA,NUMERO_TITULOS,PRECIO_TITULO,COMISION,TOTAL,COMERCIALIZADOR,MERCADO,SIMULADO) VALUES (''' || PRODUCTO_ID || ''', ''Venta'', ''2021-03-08'', ' || TRIM(CHAR(TITULOS_ACTUALES)) || ', ' || TRIM(CHAR(VALOR_TITULO)) || ', 0, ' || TRIM(CHAR(VALOR_TITULOS_ACTUALES)) || ', ''' || COMERCIALIZADOR || ''', ''' || MERCADO || ''', TRUE);' AS MOVIMIENTO_SIMULADO FROM VW02_GAN_PER_PROD_GLOBAL WHERE TITULOS_ACTUALES > 0 ORDER BY PRODUCTO_ID;
--
INSERT INTO TB02_MOVIMIENTOS (PRODUCTO_ID,COMPRA_VENTA,FECHA,NUMERO_TITULOS,PRECIO_TITULO,COMISION,TOTAL,COMERCIALIZADOR,MERCADO,SIMULADO) VALUES ('DE000A0D8Q31', 'Compra', '2021-03-08', 10.0000, 195.9100, 0, 1959.1000, 'Degiro', 'Xetra', TRUE);
1 row inserted/updated/deleted
ij> INSERT INTO TB02_MOVIMIENTOS (PRODUCTO_ID,COMPRA_VENTA,FECHA,NUMERO_TITULOS,PRECIO_TITULO,COMISION,TOTAL,COMERCIALIZADOR,MERCADO,SIMULADO) VALUES ('DE000A0S9GB0', 'Compra', '2021-03-08', 61.0000, 45.7700, 0, 2791.9700, 'SelfBank', 'Xetra', TRUE);
1 row inserted/updated/deleted
ij> INSERT INTO TB02_MOVIMIENTOS (PRODUCTO_ID,COMPRA_VENTA,FECHA,NUMERO_TITULOS,PRECIO_TITULO,COMISION,TOTAL,COMERCIALIZADOR,MERCADO,SIMULADO) VALUES ('DE000A1DCTL3', 'Compra', '2021-03-08', 31.0000, 137.0400, 0, 4248.2400, 'SelfBank', 'Xetra', TRUE);
1 row inserted/updated/deleted
ij> INSERT INTO TB02_MOVIMIENTOS (PRODUCTO_ID,COMPRA_VENTA,FECHA,NUMERO_TITULOS,PRECIO_TITULO,COMISION,TOTAL,COMERCIALIZADOR,MERCADO,SIMULADO) VALUES ('IE0007201266', 'Compra', '2021-03-08', 4.0600, 251.0800, 0, 1019.3848, 'MyInvestor', 'N/A', TRUE);
1 row inserted/updated/deleted
ij> INSERT INTO TB02_MOVIMIENTOS (PRODUCTO_ID,COMPRA_VENTA,FECHA,NUMERO_TITULOS,PRECIO_TITULO,COMISION,TOTAL,COMERCIALIZADOR,MERCADO,SIMULADO) VALUES ('IE0007286036', 'Compra', '2021-03-08', 4.3600, 230.9500, 0, 1006.9420, 'MyInvestor', 'N/A', TRUE);
1 row inserted/updated/deleted
ij> INSERT INTO TB02_MOVIMIENTOS (PRODUCTO_ID,COMPRA_VENTA,FECHA,NUMERO_TITULOS,PRECIO_TITULO,COMISION,TOTAL,COMERCIALIZADOR,MERCADO,SIMULADO) VALUES ('IE0007987708', 'Compra', '2021-03-08', 88.8100, 22.7200, 0, 2017.7632, 'MyInvestor', 'N/A', TRUE);
1 row inserted/updated/deleted
ij> INSERT INTO TB02_MOVIMIENTOS (PRODUCTO_ID,COMPRA_VENTA,FECHA,NUMERO_TITULOS,PRECIO_TITULO,COMISION,TOTAL,COMERCIALIZADOR,MERCADO,SIMULADO) VALUES ('IE0031786696', 'Compra', '2021-03-08', 9.6600, 209.3200, 0, 2022.0312, 'MyInvestor', 'N/A', TRUE);
1 row inserted/updated/deleted
ij> INSERT INTO TB02_MOVIMIENTOS (PRODUCTO_ID,COMPRA_VENTA,FECHA,NUMERO_TITULOS,PRECIO_TITULO,COMISION,TOTAL,COMERCIALIZADOR,MERCADO,SIMULADO) VALUES ('IE0032126645', 'Compra', '2021-03-08', 54.5200, 37.4500, 0, 2041.7740, 'MyInvestor', 'N/A', TRUE);
1 row inserted/updated/deleted
ij> INSERT INTO TB02_MOVIMIENTOS (PRODUCTO_ID,COMPRA_VENTA,FECHA,NUMERO_TITULOS,PRECIO_TITULO,COMISION,TOTAL,COMERCIALIZADOR,MERCADO,SIMULADO) VALUES ('IE00B579F325', 'Compra', '2021-03-08', 10.0000, 137.8100, 0, 1378.1000, 'Degiro', 'Xetra', TRUE);
1 row inserted/updated/deleted
ij> INSERT INTO TB02_MOVIMIENTOS (PRODUCTO_ID,COMPRA_VENTA,FECHA,NUMERO_TITULOS,PRECIO_TITULO,COMISION,TOTAL,COMERCIALIZADOR,MERCADO,SIMULADO) VALUES ('IE00B83YJG36', 'Compra', '2021-03-08', 89.8600, 15.6500, 0, 1406.3090, 'MyInvestor', 'N/A', TRUE);
1 row inserted/updated/deleted
ij> INSERT INTO TB02_MOVIMIENTOS (PRODUCTO_ID,COMPRA_VENTA,FECHA,NUMERO_TITULOS,PRECIO_TITULO,COMISION,TOTAL,COMERCIALIZADOR,MERCADO,SIMULADO) VALUES ('IE00BD8PGZ49', 'Compra', '2021-03-08', 370.0000, 5.1100, 0, 1890.7000, 'Degiro', 'Londres', TRUE);
1 row inserted/updated/deleted
ij> INSERT INTO TB02_MOVIMIENTOS (PRODUCTO_ID,COMPRA_VENTA,FECHA,NUMERO_TITULOS,PRECIO_TITULO,COMISION,TOTAL,COMERCIALIZADOR,MERCADO,SIMULADO) VALUES ('LU0389812933', 'Compra', '2021-03-08', 39.8050, 140.8200, 0, 5605.3401, 'Openbank', 'N/A', TRUE);
1 row inserted/updated/deleted
ij> --
--
--
CREATE VIEW VWF_EFECTIVO AS 
SELECT 
	NOMBRE_CUENTA AS "Nombre Cuenta", 
	CAST(LIQUIDO AS DECIMAL(12, 4)) AS "Liquido", 
	CAST(INMOVILIZADO AS DECIMAL(12, 4)) AS "Inmovilizado" 
FROM 
	TB00_EFECTIVO
WHERE LIQUIDO > 0 OR INMOVILIZADO > 0
UNION ALL
SELECT 
	'Total' AS "Nombre Cuenta",
	CAST(SUM(LIQUIDO) AS DECIMAL(12, 4)) AS "Liquido",
	CAST(SUM(INMOVILIZADO) AS DECIMAL(12, 4)) AS "Inmovilizado"
FROM 
	TB00_EFECTIVO
ORDER BY 3, 2;
0 rows inserted/updated/deleted
ij> --
--
--
CREATE VIEW VW01_MOVIMIENTOS_PRODUCTOS AS 
SELECT 
	MOV.MOVIMIENTO_ID, 
	MOV.PRODUCTO_ID, 
	PROD.NOMBRE, 
	MOV.COMERCIALIZADOR, 
	MOV.MERCADO, 	
	PROD.PROVEEDOR, 
	PROD.INSTRUMENTO, 
	PROD.TIPO_ACTIVO, 
	PROD.SUBTIPO_ACTIVO, 
	PROD.MONEDA, 
	PROD.USO_INGRESOS, 		
	MOV.COMPRA_VENTA, 
	MOV.FECHA, 
	MOV.NUMERO_TITULOS, 
	MOV.PRECIO_TITULO, 
	MOV.COMISION, 
	MOV.TOTAL
FROM
	TB02_MOVIMIENTOS MOV 
	INNER JOIN TB02_PRODUCTOS PROD 
	ON MOV.PRODUCTO_ID = PROD.IDENTIFICADOR;
0 rows inserted/updated/deleted
ij> --
--
--
CREATE VIEW VW02_GAN_PER_PROD_GLOBAL AS 
SELECT
	PRODUCTO_ID, 
	NOMBRE, 
	COMERCIALIZADOR, 
	MERCADO, 
	PROVEEDOR, 
	INSTRUMENTO, 
	TIPO_ACTIVO, 
	SUBTIPO_ACTIVO, 
	MONEDA, 
	USO_INGRESOS, 
	TER, 
	TITULOS_COMPRADOS, 
	PRECIO_TITULOS_COMPRADOS, 
	TITULOS_VENDIDOS, 
	PRECIO_TITULOS_VENDIDOS, 
	FLUJO_CAJA,
	TITULOS_ACTUALES, 
	VALOR_TITULO, 
	VALOR_TITULOS_ACTUALES,
	GANANCIA_PERDIDA,
	(CASE WHEN PRECIO_TITULOS_COMPRADOS > 0.0000 THEN CAST((GANANCIA_PERDIDA * 100.0000 / PRECIO_TITULOS_COMPRADOS) AS DECIMAL(12, 4)) ELSE 0.0000 END) AS GANANCIA_PERDIDA_PRCNT
FROM (
	SELECT
		PRODUCTO_ID, 
		NOMBRE, 
		COMERCIALIZADOR, 
		MERCADO, 
		PROVEEDOR, 
		INSTRUMENTO, 
		TIPO_ACTIVO, 
		SUBTIPO_ACTIVO, 
		MONEDA, 
		USO_INGRESOS, 
		TER, 
		TITULOS_COMPRADOS, 
		PRECIO_TITULOS_COMPRADOS, 
		TITULOS_VENDIDOS, 
		PRECIO_TITULOS_VENDIDOS, 
		FLUJO_CAJA,
		TITULOS_ACTUALES, 
		VALOR_TITULO, 
		VALOR_TITULOS_ACTUALES,
		CAST((PRECIO_TITULOS_VENDIDOS + VALOR_TITULOS_ACTUALES - PRECIO_TITULOS_COMPRADOS) AS DECIMAL(12, 4)) AS GANANCIA_PERDIDA 
	FROM (
		SELECT 
			PRODUCTO_ID, 
			NOMBRE, 
			COMERCIALIZADOR, 
			MERCADO, 
			PROVEEDOR, 
			INSTRUMENTO, 
			TIPO_ACTIVO, 
			SUBTIPO_ACTIVO, 
			MONEDA, 
			USO_INGRESOS, 
			TER, 
			TITULOS_COMPRADOS, 
			PRECIO_TITULOS_COMPRADOS, 
			TITULOS_VENDIDOS, 
			PRECIO_TITULOS_VENDIDOS, 
			FLUJO_CAJA,
			TITULOS_ACTUALES, 
			VALOR_TITULO, 
			CAST((TITULOS_ACTUALES * VALOR_TITULO) AS DECIMAL(12, 4)) AS VALOR_TITULOS_ACTUALES 
		FROM (
			SELECT 
				TMP_TITULOS_ACTUALES.PRODUCTO_ID, 
				TMP_TITULOS_ACTUALES.NOMBRE, 
				TMP_TITULOS_ACTUALES.COMERCIALIZADOR, 
				TMP_TITULOS_ACTUALES.MERCADO, 
				TMP_TITULOS_ACTUALES.PROVEEDOR, 
				TMP_TITULOS_ACTUALES.INSTRUMENTO, 
				TMP_TITULOS_ACTUALES.TIPO_ACTIVO, 
				TMP_TITULOS_ACTUALES.SUBTIPO_ACTIVO, 
				TMP_TITULOS_ACTUALES.MONEDA, 
				TMP_TITULOS_ACTUALES.USO_INGRESOS,				
				TMP_TITULOS_ACTUALES.TITULOS_COMPRADOS, 
				TMP_TITULOS_ACTUALES.PRECIO_TITULOS_COMPRADOS, 
				TMP_TITULOS_ACTUALES.TITULOS_VENDIDOS, 
				TMP_TITULOS_ACTUALES.PRECIO_TITULOS_VENDIDOS, 
				CAST((TMP_TITULOS_ACTUALES.PRECIO_TITULOS_VENDIDOS - TMP_TITULOS_ACTUALES.PRECIO_TITULOS_COMPRADOS) AS DECIMAL(12, 4)) AS FLUJO_CAJA, 
				CAST((TMP_TITULOS_ACTUALES.TITULOS_COMPRADOS - TMP_TITULOS_ACTUALES.TITULOS_VENDIDOS) AS DECIMAL(12, 4)) AS TITULOS_ACTUALES, 
				PVAR.VALOR_TITULO, 
				PVAR.TER
			FROM (
				SELECT 
					TMP_COMPRAS.PRODUCTO_ID, 
					TMP_COMPRAS.NOMBRE, 
					TMP_COMPRAS.COMERCIALIZADOR, 
					TMP_COMPRAS.MERCADO, 
					TMP_COMPRAS.PROVEEDOR, 
					TMP_COMPRAS.INSTRUMENTO, 
					TMP_COMPRAS.TIPO_ACTIVO, 
					TMP_COMPRAS.SUBTIPO_ACTIVO, 
					TMP_COMPRAS.MONEDA, 
					TMP_COMPRAS.USO_INGRESOS,
					TMP_COMPRAS.TITULOS_COMPRADOS, 
					TMP_COMPRAS.PRECIO_TITULOS_COMPRADOS, 
					(CASE WHEN TMP_VENTAS.TITULOS_VENDIDOS IS NULL THEN 0.0000 ELSE TMP_VENTAS.TITULOS_VENDIDOS END) AS TITULOS_VENDIDOS,
					(CASE WHEN TMP_VENTAS.PRECIO_TITULOS_VENDIDOS IS NULL THEN 0.0000 ELSE TMP_VENTAS.PRECIO_TITULOS_VENDIDOS END) AS PRECIO_TITULOS_VENDIDOS
				FROM (
					SELECT 
						PRODUCTO_ID, 
						NOMBRE, 
						COMERCIALIZADOR, 
						MERCADO, 
						PROVEEDOR, 
						INSTRUMENTO, 
						TIPO_ACTIVO, 
						SUBTIPO_ACTIVO, 
						MONEDA, 
						USO_INGRESOS,
						CAST(SUM(NUMERO_TITULOS) AS DECIMAL(12, 4)) AS TITULOS_COMPRADOS, 
						CAST(SUM((NUMERO_TITULOS * PRECIO_TITULO) + COMISION) AS DECIMAL(12, 4)) AS PRECIO_TITULOS_COMPRADOS 
					FROM VW01_MOVIMIENTOS_PRODUCTOS
					WHERE COMPRA_VENTA = 'Compra' 
					GROUP BY PRODUCTO_ID, NOMBRE, COMERCIALIZADOR, MERCADO, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS
				) 
				TMP_COMPRAS
				LEFT OUTER JOIN (
					SELECT 
						PRODUCTO_ID, 
						NOMBRE, 
						COMERCIALIZADOR, 
						MERCADO, 
						PROVEEDOR, 
						INSTRUMENTO, 
						TIPO_ACTIVO, 
						SUBTIPO_ACTIVO, 
						MONEDA, 
						USO_INGRESOS,
						CAST(SUM(NUMERO_TITULOS) AS DECIMAL(12, 4)) AS TITULOS_VENDIDOS, 
						CAST(SUM((NUMERO_TITULOS * PRECIO_TITULO) - COMISION) AS DECIMAL(12, 4)) AS PRECIO_TITULOS_VENDIDOS 
					FROM VW01_MOVIMIENTOS_PRODUCTOS
					WHERE COMPRA_VENTA = 'Venta' 
					GROUP BY PRODUCTO_ID, NOMBRE, COMERCIALIZADOR, MERCADO, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS
				) 
				TMP_VENTAS
				ON TMP_COMPRAS.PRODUCTO_ID = TMP_VENTAS.PRODUCTO_ID 
				AND TMP_COMPRAS.NOMBRE = TMP_VENTAS.NOMBRE
				AND TMP_COMPRAS.COMERCIALIZADOR = TMP_VENTAS.COMERCIALIZADOR
				AND TMP_COMPRAS.MERCADO = TMP_VENTAS.MERCADO
				AND TMP_COMPRAS.PROVEEDOR = TMP_VENTAS.PROVEEDOR
				AND TMP_COMPRAS.INSTRUMENTO = TMP_VENTAS.INSTRUMENTO
				AND TMP_COMPRAS.TIPO_ACTIVO = TMP_VENTAS.TIPO_ACTIVO
				AND TMP_COMPRAS.SUBTIPO_ACTIVO = TMP_VENTAS.SUBTIPO_ACTIVO
				AND TMP_COMPRAS.MONEDA = TMP_VENTAS.MONEDA
				AND TMP_COMPRAS.USO_INGRESOS = TMP_VENTAS.USO_INGRESOS
			) 
			TMP_TITULOS_ACTUALES
			INNER JOIN TB02_PRODUCTOS_VAR PVAR 
			ON TMP_TITULOS_ACTUALES.PRODUCTO_ID = PVAR.PRODUCTO_ID
		)
		TMP_VALOR_TITULOS_ACTUALES
	)
	TMP_GANANCIA_PERDIDA
)
TMP_GANANCIA_PERDIDA_PRCNT;
0 rows inserted/updated/deleted
ij> --
--
--
CREATE VIEW VW03_GAN_PER_PROD_PESO_GLOBAL AS 
SELECT
	PRODUCTO_ID, 
	NOMBRE, 
	COMERCIALIZADOR, 
	MERCADO, 
	PROVEEDOR, 
	INSTRUMENTO, 
	TIPO_ACTIVO, 
	SUBTIPO_ACTIVO, 
	MONEDA, 
	USO_INGRESOS, 
	TER, 
	TITULOS_COMPRADOS, 
	PRECIO_TITULOS_COMPRADOS, 
	TITULOS_VENDIDOS, 
	PRECIO_TITULOS_VENDIDOS, 
	FLUJO_CAJA,
	TITULOS_ACTUALES, 
	VALOR_TITULO, 
	VALOR_TITULOS_ACTUALES,
	GANANCIA_PERDIDA,
	GANANCIA_PERDIDA_PRCNT,
	(CASE WHEN SUM_VALOR_TITULOS_ACTUALES > 0.0000 THEN CAST((VALOR_TITULOS_ACTUALES * 100.0000 / SUM_VALOR_TITULOS_ACTUALES) AS DECIMAL(12, 4)) ELSE 0.0000 END) AS PESO_EN_CARTERA
FROM (
	SELECT 
		PRODUCTO_ID, 
		NOMBRE, 
		COMERCIALIZADOR, 
		MERCADO, 
		PROVEEDOR, 
		INSTRUMENTO, 
		TIPO_ACTIVO, 
		SUBTIPO_ACTIVO, 
		MONEDA, 
		USO_INGRESOS, 
		TER, 
		TITULOS_COMPRADOS, 
		PRECIO_TITULOS_COMPRADOS, 
		TITULOS_VENDIDOS, 
		PRECIO_TITULOS_VENDIDOS, 
		FLUJO_CAJA,
		TITULOS_ACTUALES, 
		VALOR_TITULO, 
		VALOR_TITULOS_ACTUALES,
		GANANCIA_PERDIDA,
		GANANCIA_PERDIDA_PRCNT,
		SUM_VALOR_TITULOS_ACTUALES
	FROM VW02_GAN_PER_PROD_GLOBAL
	CROSS JOIN (
		SELECT SUM(VALOR_TITULOS_ACTUALES) AS SUM_VALOR_TITULOS_ACTUALES FROM VW02_GAN_PER_PROD_GLOBAL
	) 
	TMP_SUM_VALOR_TITULOS_ACTUALES
)
TMP_GAN_PER_PROD_PESO;
0 rows inserted/updated/deleted
ij> --
--
--
CREATE VIEW VWF_GAN_PER_PROD_PESO_GLOBAL AS 
SELECT
	PRODUCTO_ID AS "ISIN",
	NOMBRE AS "Nombre", 
	COMERCIALIZADOR AS "Comercializador", 
	MERCADO AS "Mercado", 
	PROVEEDOR AS "Proveedor", 
	INSTRUMENTO AS "Instrumento", 
	TIPO_ACTIVO AS "Tipo Activo", 
	SUBTIPO_ACTIVO AS "Subtipo Activo", 
	MONEDA AS "Moneda", 
	USO_INGRESOS AS "Uso Ingresos",		
	CAST(TER AS DECIMAL(12, 4)) AS "TER", 
	CAST(TITULOS_COMPRADOS AS DECIMAL(12, 4)) AS "Tit. Compra", 
	CAST(PRECIO_TITULOS_COMPRADOS AS DECIMAL(12, 4)) AS "Prec. Tit. C.", 
	CAST(TITULOS_VENDIDOS AS DECIMAL(12, 4)) AS "Tit. Venta", 
	CAST(PRECIO_TITULOS_VENDIDOS AS DECIMAL(12, 4)) AS "Prec. Tit. V.", 
	CAST(FLUJO_CAJA AS DECIMAL(12, 4)) AS "Flujo Caja", 
	CAST(TITULOS_ACTUALES AS DECIMAL(12, 4)) AS "Tit. Act.", 
	CAST(VALOR_TITULO AS DECIMAL(12, 4)) AS "Val. Tit.", 
	CAST(VALOR_TITULOS_ACTUALES AS DECIMAL(12, 4)) AS "Val. Tit. Act.",
	CAST(GANANCIA_PERDIDA AS DECIMAL(12, 4)) AS "Gan./Perd.",
	CAST(GANANCIA_PERDIDA_PRCNT AS DECIMAL(12, 4)) AS "Gan./Perd. %",
	(CASE WHEN CAST(PESO_EN_CARTERA AS DECIMAL(12, 4)) >= 99.99 THEN 100.0000 ELSE CAST(PESO_EN_CARTERA AS DECIMAL(12, 4)) END) AS "Peso %"
FROM VW03_GAN_PER_PROD_PESO_GLOBAL
ORDER BY 22;
0 rows inserted/updated/deleted
ij> --
--
--
CREATE VIEW VWF_GAN_PER_PROD_PESO_GLOBAL_TOTALES AS 	
SELECT 
	(CASE WHEN VALOR_TITULOS_ACTUALES > 0.0000 THEN CAST((TER_BRUTO / VALOR_TITULOS_ACTUALES) AS DECIMAL(12, 4)) ELSE 0.0000 END) AS "TER",  
	CAST(PRECIO_TITULOS_COMPRADOS AS DECIMAL(12, 4)) AS "Prec. Tit. C.", 
	CAST(PRECIO_TITULOS_VENDIDOS AS DECIMAL(12, 4)) AS "Prec. Tit. V.", 
	CAST(FLUJO_CAJA AS DECIMAL(12, 4)) AS "Flujo Caja", 
	CAST(VALOR_TITULOS_ACTUALES AS DECIMAL(12, 4)) AS "Val. Tit. Act.",
	CAST(GANANCIA_PERDIDA AS DECIMAL(12, 4)) AS "Gan./Perd.",
	(CASE WHEN PRECIO_TITULOS_COMPRADOS > 0.0000 THEN CAST((GANANCIA_PERDIDA * 100.0000 / PRECIO_TITULOS_COMPRADOS) AS DECIMAL(12, 4)) ELSE 0.0000 END) AS "Gan./Perd. %", 
	(CASE WHEN CAST(PESO_EN_CARTERA AS DECIMAL(12, 4)) >= 99.99 THEN 100.0000 ELSE CAST(PESO_EN_CARTERA AS DECIMAL(12, 4)) END) AS "Peso %" 
FROM (
	SELECT  
		SUM(VALOR_TITULOS_ACTUALES * TER ) AS TER_BRUTO,
		SUM(PRECIO_TITULOS_COMPRADOS) AS PRECIO_TITULOS_COMPRADOS, 
		SUM(PRECIO_TITULOS_VENDIDOS) AS PRECIO_TITULOS_VENDIDOS, 
		SUM(FLUJO_CAJA) AS FLUJO_CAJA, 
		SUM(VALOR_TITULOS_ACTUALES) VALOR_TITULOS_ACTUALES, 
		SUM(GANANCIA_PERDIDA) GANANCIA_PERDIDA, 
		SUM(PESO_EN_CARTERA) AS PESO_EN_CARTERA 
	FROM 
		VW03_GAN_PER_PROD_PESO_GLOBAL
) 
TMP_GANANCIA_PERDIDA_PRCNT
ORDER BY 8;
0 rows inserted/updated/deleted
ij> --
--
--
CREATE VIEW VWF_COMERCIALIZADOR AS 	
SELECT 
	COMERCIALIZADOR AS "Comercializador", 
	CAST(PRECIO_TITULOS_COMPRADOS AS DECIMAL(12, 4)) AS "Prec. Tit. C.", 
	CAST(PRECIO_TITULOS_VENDIDOS AS DECIMAL(12, 4)) AS "Prec. Tit. V.", 
	CAST(FLUJO_CAJA AS DECIMAL(12, 4)) AS "Flujo Caja", 
	CAST(VALOR_TITULOS_ACTUALES AS DECIMAL(12, 4)) AS "Val. Tit. Act.",
	CAST(GANANCIA_PERDIDA AS DECIMAL(12, 4)) AS "Gan./Perd.",
	(CASE WHEN PRECIO_TITULOS_COMPRADOS > 0.0000 THEN CAST((GANANCIA_PERDIDA * 100.0000 / PRECIO_TITULOS_COMPRADOS) AS DECIMAL(12, 4)) ELSE 0.0000 END) AS "Gan./Perd. %", 
	(CASE WHEN CAST(PESO_EN_CARTERA AS DECIMAL(12, 4)) >= 99.99 THEN 100.0000 ELSE CAST(PESO_EN_CARTERA AS DECIMAL(12, 4)) END) AS "Peso %" 
FROM (
	SELECT 
		COMERCIALIZADOR, 
		SUM(PRECIO_TITULOS_COMPRADOS) AS PRECIO_TITULOS_COMPRADOS, 
		SUM(PRECIO_TITULOS_VENDIDOS) AS PRECIO_TITULOS_VENDIDOS, 
		SUM(FLUJO_CAJA) AS FLUJO_CAJA, 
		SUM(VALOR_TITULOS_ACTUALES) VALOR_TITULOS_ACTUALES, 
		SUM(GANANCIA_PERDIDA) GANANCIA_PERDIDA, 
		SUM(PESO_EN_CARTERA) AS PESO_EN_CARTERA 
	FROM 
		VW03_GAN_PER_PROD_PESO_GLOBAL
	GROUP BY
		COMERCIALIZADOR
) 
TMP_GANANCIA_PERDIDA_PRCNT
ORDER BY 8;
0 rows inserted/updated/deleted
ij> --
--
--
CREATE VIEW VWF_MERCADO AS 	
SELECT 
	MERCADO AS "Mercado", 
	CAST(PRECIO_TITULOS_COMPRADOS AS DECIMAL(12, 4)) AS "Prec. Tit. C.", 
	CAST(PRECIO_TITULOS_VENDIDOS AS DECIMAL(12, 4)) AS "Prec. Tit. V.", 
	CAST(FLUJO_CAJA AS DECIMAL(12, 4)) AS "Flujo Caja", 
	CAST(VALOR_TITULOS_ACTUALES AS DECIMAL(12, 4)) AS "Val. Tit. Act.",
	CAST(GANANCIA_PERDIDA AS DECIMAL(12, 4)) AS "Gan./Perd.",
	(CASE WHEN PRECIO_TITULOS_COMPRADOS > 0.0000 THEN CAST((GANANCIA_PERDIDA * 100.0000 / PRECIO_TITULOS_COMPRADOS) AS DECIMAL(12, 4)) ELSE 0.0000 END) AS "Gan./Perd. %", 
	(CASE WHEN CAST(PESO_EN_CARTERA AS DECIMAL(12, 4)) >= 99.99 THEN 100.0000 ELSE CAST(PESO_EN_CARTERA AS DECIMAL(12, 4)) END) AS "Peso %" 
FROM (
	SELECT 
		MERCADO, 
		SUM(PRECIO_TITULOS_COMPRADOS) AS PRECIO_TITULOS_COMPRADOS, 
		SUM(PRECIO_TITULOS_VENDIDOS) AS PRECIO_TITULOS_VENDIDOS, 
		SUM(FLUJO_CAJA) AS FLUJO_CAJA, 
		SUM(VALOR_TITULOS_ACTUALES) VALOR_TITULOS_ACTUALES, 
		SUM(GANANCIA_PERDIDA) GANANCIA_PERDIDA, 
		SUM(PESO_EN_CARTERA) AS PESO_EN_CARTERA 
	FROM 
		VW03_GAN_PER_PROD_PESO_GLOBAL
	GROUP BY
		MERCADO
) 
TMP_GANANCIA_PERDIDA_PRCNT
ORDER BY 8;
0 rows inserted/updated/deleted
ij> --
--
--
CREATE VIEW VWF_PROVEEDOR AS 	
SELECT 
	PROVEEDOR AS "Proveedor", 
	CAST(PRECIO_TITULOS_COMPRADOS AS DECIMAL(12, 4)) AS "Prec. Tit. C.", 
	CAST(PRECIO_TITULOS_VENDIDOS AS DECIMAL(12, 4)) AS "Prec. Tit. V.", 
	CAST(FLUJO_CAJA AS DECIMAL(12, 4)) AS "Flujo Caja", 
	CAST(VALOR_TITULOS_ACTUALES AS DECIMAL(12, 4)) AS "Val. Tit. Act.",
	CAST(GANANCIA_PERDIDA AS DECIMAL(12, 4)) AS "Gan./Perd.",
	(CASE WHEN PRECIO_TITULOS_COMPRADOS > 0.0000 THEN CAST((GANANCIA_PERDIDA * 100.0000 / PRECIO_TITULOS_COMPRADOS) AS DECIMAL(12, 4)) ELSE 0.0000 END) AS "Gan./Perd. %", 
	(CASE WHEN CAST(PESO_EN_CARTERA AS DECIMAL(12, 4)) >= 99.99 THEN 100.0000 ELSE CAST(PESO_EN_CARTERA AS DECIMAL(12, 4)) END) AS "Peso %" 
FROM (
	SELECT 
		PROVEEDOR, 
		SUM(PRECIO_TITULOS_COMPRADOS) AS PRECIO_TITULOS_COMPRADOS, 
		SUM(PRECIO_TITULOS_VENDIDOS) AS PRECIO_TITULOS_VENDIDOS, 
		SUM(FLUJO_CAJA) AS FLUJO_CAJA, 
		SUM(VALOR_TITULOS_ACTUALES) VALOR_TITULOS_ACTUALES, 
		SUM(GANANCIA_PERDIDA) GANANCIA_PERDIDA, 
		SUM(PESO_EN_CARTERA) AS PESO_EN_CARTERA 
	FROM 
		VW03_GAN_PER_PROD_PESO_GLOBAL
	GROUP BY
		PROVEEDOR
) 
TMP_GANANCIA_PERDIDA_PRCNT
ORDER BY 8;
0 rows inserted/updated/deleted
ij> --
--
--
CREATE VIEW VWF_INSTRUMENTO AS 	
SELECT 
	INSTRUMENTO AS "Instrumento", 
	CAST(PRECIO_TITULOS_COMPRADOS AS DECIMAL(12, 4)) AS "Prec. Tit. C.", 
	CAST(PRECIO_TITULOS_VENDIDOS AS DECIMAL(12, 4)) AS "Prec. Tit. V.", 
	CAST(FLUJO_CAJA AS DECIMAL(12, 4)) AS "Flujo Caja", 
	CAST(VALOR_TITULOS_ACTUALES AS DECIMAL(12, 4)) AS "Val. Tit. Act.",
	CAST(GANANCIA_PERDIDA AS DECIMAL(12, 4)) AS "Gan./Perd.",
	(CASE WHEN PRECIO_TITULOS_COMPRADOS > 0.0000 THEN CAST((GANANCIA_PERDIDA * 100.0000 / PRECIO_TITULOS_COMPRADOS) AS DECIMAL(12, 4)) ELSE 0.0000 END) AS "Gan./Perd. %", 
	(CASE WHEN CAST(PESO_EN_CARTERA AS DECIMAL(12, 4)) >= 99.99 THEN 100.0000 ELSE CAST(PESO_EN_CARTERA AS DECIMAL(12, 4)) END) AS "Peso %" 
FROM (
	SELECT 
		INSTRUMENTO, 
		SUM(PRECIO_TITULOS_COMPRADOS) AS PRECIO_TITULOS_COMPRADOS, 
		SUM(PRECIO_TITULOS_VENDIDOS) AS PRECIO_TITULOS_VENDIDOS, 
		SUM(FLUJO_CAJA) AS FLUJO_CAJA, 
		SUM(VALOR_TITULOS_ACTUALES) VALOR_TITULOS_ACTUALES, 
		SUM(GANANCIA_PERDIDA) GANANCIA_PERDIDA, 
		SUM(PESO_EN_CARTERA) AS PESO_EN_CARTERA 
	FROM 
		VW03_GAN_PER_PROD_PESO_GLOBAL
	GROUP BY
		INSTRUMENTO
) 
TMP_GANANCIA_PERDIDA_PRCNT
ORDER BY 8;
0 rows inserted/updated/deleted
ij> --
--
--
CREATE VIEW VWF_TIPO_ACTIVO AS 	
SELECT 
	TIPO_ACTIVO AS "Tipo Activo", 
	CAST(PRECIO_TITULOS_COMPRADOS AS DECIMAL(12, 4)) AS "Prec. Tit. C.", 
	CAST(PRECIO_TITULOS_VENDIDOS AS DECIMAL(12, 4)) AS "Prec. Tit. V.", 
	CAST(FLUJO_CAJA AS DECIMAL(12, 4)) AS "Flujo Caja", 
	CAST(VALOR_TITULOS_ACTUALES AS DECIMAL(12, 4)) AS "Val. Tit. Act.",
	CAST(GANANCIA_PERDIDA AS DECIMAL(12, 4)) AS "Gan./Perd.",
	(CASE WHEN PRECIO_TITULOS_COMPRADOS > 0.0000 THEN CAST((GANANCIA_PERDIDA * 100.0000 / PRECIO_TITULOS_COMPRADOS) AS DECIMAL(12, 4)) ELSE 0.0000 END) AS "Gan./Perd. %", 
	(CASE WHEN CAST(PESO_EN_CARTERA AS DECIMAL(12, 4)) >= 99.99 THEN 100.0000 ELSE CAST(PESO_EN_CARTERA AS DECIMAL(12, 4)) END) AS "Peso %" 
FROM (
	SELECT 
		TIPO_ACTIVO, 
		SUM(PRECIO_TITULOS_COMPRADOS) AS PRECIO_TITULOS_COMPRADOS, 
		SUM(PRECIO_TITULOS_VENDIDOS) AS PRECIO_TITULOS_VENDIDOS, 
		SUM(FLUJO_CAJA) AS FLUJO_CAJA, 
		SUM(VALOR_TITULOS_ACTUALES) VALOR_TITULOS_ACTUALES, 
		SUM(GANANCIA_PERDIDA) GANANCIA_PERDIDA, 
		SUM(PESO_EN_CARTERA) AS PESO_EN_CARTERA 
	FROM 
		VW03_GAN_PER_PROD_PESO_GLOBAL
	GROUP BY
		TIPO_ACTIVO
) 
TMP_GANANCIA_PERDIDA_PRCNT
ORDER BY 8;
0 rows inserted/updated/deleted
ij> --
--
--
CREATE VIEW VWF_SUBTIPO_ACTIVO_GLOBAL AS 	
SELECT 
	SUBTIPO_ACTIVO AS "Subtipo Activo",
	CAST(PRECIO_TITULOS_COMPRADOS AS DECIMAL(12, 4)) AS "Prec. Tit. C.", 
	CAST(PRECIO_TITULOS_VENDIDOS AS DECIMAL(12, 4)) AS "Prec. Tit. V.", 
	CAST(FLUJO_CAJA AS DECIMAL(12, 4)) AS "Flujo Caja", 
	CAST(VALOR_TITULOS_ACTUALES AS DECIMAL(12, 4)) AS "Val. Tit. Act.",
	CAST(GANANCIA_PERDIDA AS DECIMAL(12, 4)) AS "Gan./Perd.",
	(CASE WHEN PRECIO_TITULOS_COMPRADOS > 0.0000 THEN CAST((GANANCIA_PERDIDA * 100.0000 / PRECIO_TITULOS_COMPRADOS) AS DECIMAL(12, 4)) ELSE 0.0000 END) AS "Gan./Perd. %", 
	(CASE WHEN CAST(PESO_EN_CARTERA AS DECIMAL(12, 4)) >= 99.99 THEN 100.0000 ELSE CAST(PESO_EN_CARTERA AS DECIMAL(12, 4)) END) AS "Peso %" 
FROM (
	SELECT 
		SUBTIPO_ACTIVO,
		SUM(PRECIO_TITULOS_COMPRADOS) AS PRECIO_TITULOS_COMPRADOS, 
		SUM(PRECIO_TITULOS_VENDIDOS) AS PRECIO_TITULOS_VENDIDOS, 
		SUM(FLUJO_CAJA) AS FLUJO_CAJA, 
		SUM(VALOR_TITULOS_ACTUALES) VALOR_TITULOS_ACTUALES, 
		SUM(GANANCIA_PERDIDA) GANANCIA_PERDIDA, 
		SUM(PESO_EN_CARTERA) AS PESO_EN_CARTERA 
	FROM 
		VW03_GAN_PER_PROD_PESO_GLOBAL
	GROUP BY
		SUBTIPO_ACTIVO
) 
TMP_GANANCIA_PERDIDA_PRCNT
ORDER BY 8;
0 rows inserted/updated/deleted
ij> --
--
--
CREATE VIEW VWF_MONEDA AS 	
SELECT 
	MONEDA AS "Moneda", 
	CAST(PRECIO_TITULOS_COMPRADOS AS DECIMAL(12, 4)) AS "Prec. Tit. C.", 
	CAST(PRECIO_TITULOS_VENDIDOS AS DECIMAL(12, 4)) AS "Prec. Tit. V.", 
	CAST(FLUJO_CAJA AS DECIMAL(12, 4)) AS "Flujo Caja", 
	CAST(VALOR_TITULOS_ACTUALES AS DECIMAL(12, 4)) AS "Val. Tit. Act.",
	CAST(GANANCIA_PERDIDA AS DECIMAL(12, 4)) AS "Gan./Perd.",
	(CASE WHEN PRECIO_TITULOS_COMPRADOS > 0.0000 THEN CAST((GANANCIA_PERDIDA * 100.0000 / PRECIO_TITULOS_COMPRADOS) AS DECIMAL(12, 4)) ELSE 0.0000 END) AS "Gan./Perd. %", 
	(CASE WHEN CAST(PESO_EN_CARTERA AS DECIMAL(12, 4)) >= 99.99 THEN 100.0000 ELSE CAST(PESO_EN_CARTERA AS DECIMAL(12, 4)) END) AS "Peso %" 
FROM (
	SELECT 
		MONEDA, 
		SUM(PRECIO_TITULOS_COMPRADOS) AS PRECIO_TITULOS_COMPRADOS, 
		SUM(PRECIO_TITULOS_VENDIDOS) AS PRECIO_TITULOS_VENDIDOS, 
		SUM(FLUJO_CAJA) AS FLUJO_CAJA, 
		SUM(VALOR_TITULOS_ACTUALES) VALOR_TITULOS_ACTUALES, 
		SUM(GANANCIA_PERDIDA) GANANCIA_PERDIDA, 
		SUM(PESO_EN_CARTERA) AS PESO_EN_CARTERA 
	FROM 
		VW03_GAN_PER_PROD_PESO_GLOBAL
	GROUP BY
		MONEDA
) 
TMP_GANANCIA_PERDIDA_PRCNT
ORDER BY 8;
0 rows inserted/updated/deleted
ij> --
--
--
CREATE VIEW VWF_USO_INGRESOS AS 	
SELECT 
	USO_INGRESOS AS "Uso Ingresos", 
	CAST(PRECIO_TITULOS_COMPRADOS AS DECIMAL(12, 4)) AS "Prec. Tit. C.", 
	CAST(PRECIO_TITULOS_VENDIDOS AS DECIMAL(12, 4)) AS "Prec. Tit. V.", 
	CAST(FLUJO_CAJA AS DECIMAL(12, 4)) AS "Flujo Caja", 
	CAST(VALOR_TITULOS_ACTUALES AS DECIMAL(12, 4)) AS "Val. Tit. Act.",
	CAST(GANANCIA_PERDIDA AS DECIMAL(12, 4)) AS "Gan./Perd.",
	(CASE WHEN PRECIO_TITULOS_COMPRADOS > 0.0000 THEN CAST((GANANCIA_PERDIDA * 100.0000 / PRECIO_TITULOS_COMPRADOS) AS DECIMAL(12, 4)) ELSE 0.0000 END) AS "Gan./Perd. %", 
	(CASE WHEN CAST(PESO_EN_CARTERA AS DECIMAL(12, 4)) >= 99.99 THEN 100.0000 ELSE CAST(PESO_EN_CARTERA AS DECIMAL(12, 4)) END) AS "Peso %" 
FROM (
	SELECT 
		USO_INGRESOS, 
		SUM(PRECIO_TITULOS_COMPRADOS) AS PRECIO_TITULOS_COMPRADOS, 
		SUM(PRECIO_TITULOS_VENDIDOS) AS PRECIO_TITULOS_VENDIDOS, 
		SUM(FLUJO_CAJA) AS FLUJO_CAJA, 
		SUM(VALOR_TITULOS_ACTUALES) VALOR_TITULOS_ACTUALES, 
		SUM(GANANCIA_PERDIDA) GANANCIA_PERDIDA, 
		SUM(PESO_EN_CARTERA) AS PESO_EN_CARTERA 
	FROM 
		VW03_GAN_PER_PROD_PESO_GLOBAL
	GROUP BY
		USO_INGRESOS
) 
TMP_GANANCIA_PERDIDA_PRCNT
ORDER BY 8;
0 rows inserted/updated/deleted
ij> --
--
--
CREATE VIEW VW02_GAN_PER_PROD_ORO AS 
SELECT
	PRODUCTO_ID, 
	NOMBRE, 
	COMERCIALIZADOR, 
	MERCADO, 
	PROVEEDOR, 
	INSTRUMENTO, 
	TIPO_ACTIVO, 
	SUBTIPO_ACTIVO, 
	MONEDA, 
	USO_INGRESOS, 
	TER, 
	TITULOS_COMPRADOS, 
	PRECIO_TITULOS_COMPRADOS, 
	TITULOS_VENDIDOS, 
	PRECIO_TITULOS_VENDIDOS, 
	FLUJO_CAJA,
	TITULOS_ACTUALES, 
	VALOR_TITULO, 
	VALOR_TITULOS_ACTUALES,
	GANANCIA_PERDIDA,
	(CASE WHEN PRECIO_TITULOS_COMPRADOS > 0.0000 THEN CAST((GANANCIA_PERDIDA * 100.0000 / PRECIO_TITULOS_COMPRADOS) AS DECIMAL(12, 4)) ELSE 0.0000 END) AS GANANCIA_PERDIDA_PRCNT
FROM (
	SELECT
		PRODUCTO_ID, 
		NOMBRE, 
		COMERCIALIZADOR, 
		MERCADO, 
		PROVEEDOR, 
		INSTRUMENTO, 
		TIPO_ACTIVO, 
		SUBTIPO_ACTIVO, 
		MONEDA, 
		USO_INGRESOS, 
		TER, 
		TITULOS_COMPRADOS, 
		PRECIO_TITULOS_COMPRADOS, 
		TITULOS_VENDIDOS, 
		PRECIO_TITULOS_VENDIDOS, 
		FLUJO_CAJA,
		TITULOS_ACTUALES, 
		VALOR_TITULO, 
		VALOR_TITULOS_ACTUALES,
		CAST((PRECIO_TITULOS_VENDIDOS + VALOR_TITULOS_ACTUALES - PRECIO_TITULOS_COMPRADOS) AS DECIMAL(12, 4)) AS GANANCIA_PERDIDA 
	FROM (
		SELECT 
			PRODUCTO_ID, 
			NOMBRE, 
			COMERCIALIZADOR, 
			MERCADO, 
			PROVEEDOR, 
			INSTRUMENTO, 
			TIPO_ACTIVO, 
			SUBTIPO_ACTIVO, 
			MONEDA, 
			USO_INGRESOS, 
			TER, 
			TITULOS_COMPRADOS, 
			PRECIO_TITULOS_COMPRADOS, 
			TITULOS_VENDIDOS, 
			PRECIO_TITULOS_VENDIDOS, 
			FLUJO_CAJA,
			TITULOS_ACTUALES, 
			VALOR_TITULO, 
			CAST((TITULOS_ACTUALES * VALOR_TITULO) AS DECIMAL(12, 4)) AS VALOR_TITULOS_ACTUALES 
		FROM (
			SELECT 
				TMP_TITULOS_ACTUALES.PRODUCTO_ID, 
				TMP_TITULOS_ACTUALES.NOMBRE, 
				TMP_TITULOS_ACTUALES.COMERCIALIZADOR, 
				TMP_TITULOS_ACTUALES.MERCADO, 
				TMP_TITULOS_ACTUALES.PROVEEDOR, 
				TMP_TITULOS_ACTUALES.INSTRUMENTO, 
				TMP_TITULOS_ACTUALES.TIPO_ACTIVO, 
				TMP_TITULOS_ACTUALES.SUBTIPO_ACTIVO, 
				TMP_TITULOS_ACTUALES.MONEDA, 
				TMP_TITULOS_ACTUALES.USO_INGRESOS,				
				TMP_TITULOS_ACTUALES.TITULOS_COMPRADOS, 
				TMP_TITULOS_ACTUALES.PRECIO_TITULOS_COMPRADOS, 
				TMP_TITULOS_ACTUALES.TITULOS_VENDIDOS, 
				TMP_TITULOS_ACTUALES.PRECIO_TITULOS_VENDIDOS, 
				CAST((TMP_TITULOS_ACTUALES.PRECIO_TITULOS_VENDIDOS - TMP_TITULOS_ACTUALES.PRECIO_TITULOS_COMPRADOS) AS DECIMAL(12, 4)) AS FLUJO_CAJA, 
				CAST((TMP_TITULOS_ACTUALES.TITULOS_COMPRADOS - TMP_TITULOS_ACTUALES.TITULOS_VENDIDOS) AS DECIMAL(12, 4)) AS TITULOS_ACTUALES, 
				PVAR.VALOR_TITULO, 
				PVAR.TER
			FROM (
				SELECT 
					TMP_COMPRAS.PRODUCTO_ID, 
					TMP_COMPRAS.NOMBRE, 
					TMP_COMPRAS.COMERCIALIZADOR, 
					TMP_COMPRAS.MERCADO, 
					TMP_COMPRAS.PROVEEDOR, 
					TMP_COMPRAS.INSTRUMENTO, 
					TMP_COMPRAS.TIPO_ACTIVO, 
					TMP_COMPRAS.SUBTIPO_ACTIVO, 
					TMP_COMPRAS.MONEDA, 
					TMP_COMPRAS.USO_INGRESOS,
					TMP_COMPRAS.TITULOS_COMPRADOS, 
					TMP_COMPRAS.PRECIO_TITULOS_COMPRADOS, 
					(CASE WHEN TMP_VENTAS.TITULOS_VENDIDOS IS NULL THEN 0.0000 ELSE TMP_VENTAS.TITULOS_VENDIDOS END) AS TITULOS_VENDIDOS,
					(CASE WHEN TMP_VENTAS.PRECIO_TITULOS_VENDIDOS IS NULL THEN 0.0000 ELSE TMP_VENTAS.PRECIO_TITULOS_VENDIDOS END) AS PRECIO_TITULOS_VENDIDOS
				FROM (
					SELECT 
						PRODUCTO_ID, 
						NOMBRE, 
						COMERCIALIZADOR, 
						MERCADO, 
						PROVEEDOR, 
						INSTRUMENTO, 
						TIPO_ACTIVO, 
						SUBTIPO_ACTIVO, 
						MONEDA, 
						USO_INGRESOS,
						CAST(SUM(NUMERO_TITULOS) AS DECIMAL(12, 4)) AS TITULOS_COMPRADOS, 
						CAST(SUM((NUMERO_TITULOS * PRECIO_TITULO) + COMISION) AS DECIMAL(12, 4)) AS PRECIO_TITULOS_COMPRADOS 
					FROM VW01_MOVIMIENTOS_PRODUCTOS
					WHERE COMPRA_VENTA = 'Compra' 
					AND TIPO_ACTIVO = 'Oro'
					GROUP BY PRODUCTO_ID, NOMBRE, COMERCIALIZADOR, MERCADO, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS
				) 
				TMP_COMPRAS
				LEFT OUTER JOIN (
					SELECT 
						PRODUCTO_ID, 
						NOMBRE, 
						COMERCIALIZADOR, 
						MERCADO, 
						PROVEEDOR, 
						INSTRUMENTO, 
						TIPO_ACTIVO, 
						SUBTIPO_ACTIVO, 
						MONEDA, 
						USO_INGRESOS,
						CAST(SUM(NUMERO_TITULOS) AS DECIMAL(12, 4)) AS TITULOS_VENDIDOS, 
						CAST(SUM((NUMERO_TITULOS * PRECIO_TITULO) - COMISION) AS DECIMAL(12, 4)) AS PRECIO_TITULOS_VENDIDOS 
					FROM VW01_MOVIMIENTOS_PRODUCTOS
					WHERE COMPRA_VENTA = 'Venta' 
					AND TIPO_ACTIVO = 'Oro'
					GROUP BY PRODUCTO_ID, NOMBRE, COMERCIALIZADOR, MERCADO, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS
				) 
				TMP_VENTAS
				ON TMP_COMPRAS.PRODUCTO_ID = TMP_VENTAS.PRODUCTO_ID 
				AND TMP_COMPRAS.NOMBRE = TMP_VENTAS.NOMBRE
				AND TMP_COMPRAS.COMERCIALIZADOR = TMP_VENTAS.COMERCIALIZADOR
				AND TMP_COMPRAS.MERCADO = TMP_VENTAS.MERCADO
				AND TMP_COMPRAS.PROVEEDOR = TMP_VENTAS.PROVEEDOR
				AND TMP_COMPRAS.INSTRUMENTO = TMP_VENTAS.INSTRUMENTO
				AND TMP_COMPRAS.TIPO_ACTIVO = TMP_VENTAS.TIPO_ACTIVO
				AND TMP_COMPRAS.SUBTIPO_ACTIVO = TMP_VENTAS.SUBTIPO_ACTIVO
				AND TMP_COMPRAS.MONEDA = TMP_VENTAS.MONEDA
				AND TMP_COMPRAS.USO_INGRESOS = TMP_VENTAS.USO_INGRESOS
			) 
			TMP_TITULOS_ACTUALES
			INNER JOIN TB02_PRODUCTOS_VAR PVAR 
			ON TMP_TITULOS_ACTUALES.PRODUCTO_ID = PVAR.PRODUCTO_ID
		)
		TMP_VALOR_TITULOS_ACTUALES
	)
	TMP_GANANCIA_PERDIDA
)
TMP_GANANCIA_PERDIDA_PRCNT;
0 rows inserted/updated/deleted
ij> --
--
--
CREATE VIEW VW02_GAN_PER_PROD_RF AS 
SELECT
	PRODUCTO_ID, 
	NOMBRE, 
	COMERCIALIZADOR, 
	MERCADO, 
	PROVEEDOR, 
	INSTRUMENTO, 
	TIPO_ACTIVO, 
	SUBTIPO_ACTIVO, 
	MONEDA, 
	USO_INGRESOS, 
	TER, 
	TITULOS_COMPRADOS, 
	PRECIO_TITULOS_COMPRADOS, 
	TITULOS_VENDIDOS, 
	PRECIO_TITULOS_VENDIDOS, 
	FLUJO_CAJA,
	TITULOS_ACTUALES, 
	VALOR_TITULO, 
	VALOR_TITULOS_ACTUALES,
	GANANCIA_PERDIDA,
	(CASE WHEN PRECIO_TITULOS_COMPRADOS > 0.0000 THEN CAST((GANANCIA_PERDIDA * 100.0000 / PRECIO_TITULOS_COMPRADOS) AS DECIMAL(12, 4)) ELSE 0.0000 END) AS GANANCIA_PERDIDA_PRCNT
FROM (
	SELECT
		PRODUCTO_ID, 
		NOMBRE, 
		COMERCIALIZADOR, 
		MERCADO, 
		PROVEEDOR, 
		INSTRUMENTO, 
		TIPO_ACTIVO, 
		SUBTIPO_ACTIVO, 
		MONEDA, 
		USO_INGRESOS, 
		TER, 
		TITULOS_COMPRADOS, 
		PRECIO_TITULOS_COMPRADOS, 
		TITULOS_VENDIDOS, 
		PRECIO_TITULOS_VENDIDOS, 
		FLUJO_CAJA,
		TITULOS_ACTUALES, 
		VALOR_TITULO, 
		VALOR_TITULOS_ACTUALES,
		CAST((PRECIO_TITULOS_VENDIDOS + VALOR_TITULOS_ACTUALES - PRECIO_TITULOS_COMPRADOS) AS DECIMAL(12, 4)) AS GANANCIA_PERDIDA 
	FROM (
		SELECT 
			PRODUCTO_ID, 
			NOMBRE, 
			COMERCIALIZADOR, 
			MERCADO, 
			PROVEEDOR, 
			INSTRUMENTO, 
			TIPO_ACTIVO, 
			SUBTIPO_ACTIVO, 
			MONEDA, 
			USO_INGRESOS, 
			TER, 
			TITULOS_COMPRADOS, 
			PRECIO_TITULOS_COMPRADOS, 
			TITULOS_VENDIDOS, 
			PRECIO_TITULOS_VENDIDOS, 
			FLUJO_CAJA,
			TITULOS_ACTUALES, 
			VALOR_TITULO, 
			CAST((TITULOS_ACTUALES * VALOR_TITULO) AS DECIMAL(12, 4)) AS VALOR_TITULOS_ACTUALES 
		FROM (
			SELECT 
				TMP_TITULOS_ACTUALES.PRODUCTO_ID, 
				TMP_TITULOS_ACTUALES.NOMBRE, 
				TMP_TITULOS_ACTUALES.COMERCIALIZADOR, 
				TMP_TITULOS_ACTUALES.MERCADO, 
				TMP_TITULOS_ACTUALES.PROVEEDOR, 
				TMP_TITULOS_ACTUALES.INSTRUMENTO, 
				TMP_TITULOS_ACTUALES.TIPO_ACTIVO, 
				TMP_TITULOS_ACTUALES.SUBTIPO_ACTIVO, 
				TMP_TITULOS_ACTUALES.MONEDA, 
				TMP_TITULOS_ACTUALES.USO_INGRESOS,				
				TMP_TITULOS_ACTUALES.TITULOS_COMPRADOS, 
				TMP_TITULOS_ACTUALES.PRECIO_TITULOS_COMPRADOS, 
				TMP_TITULOS_ACTUALES.TITULOS_VENDIDOS, 
				TMP_TITULOS_ACTUALES.PRECIO_TITULOS_VENDIDOS, 
				CAST((TMP_TITULOS_ACTUALES.PRECIO_TITULOS_VENDIDOS - TMP_TITULOS_ACTUALES.PRECIO_TITULOS_COMPRADOS) AS DECIMAL(12, 4)) AS FLUJO_CAJA, 
				CAST((TMP_TITULOS_ACTUALES.TITULOS_COMPRADOS - TMP_TITULOS_ACTUALES.TITULOS_VENDIDOS) AS DECIMAL(12, 4)) AS TITULOS_ACTUALES, 
				PVAR.VALOR_TITULO, 
				PVAR.TER
			FROM (
				SELECT 
					TMP_COMPRAS.PRODUCTO_ID, 
					TMP_COMPRAS.NOMBRE, 
					TMP_COMPRAS.COMERCIALIZADOR, 
					TMP_COMPRAS.MERCADO, 
					TMP_COMPRAS.PROVEEDOR, 
					TMP_COMPRAS.INSTRUMENTO, 
					TMP_COMPRAS.TIPO_ACTIVO, 
					TMP_COMPRAS.SUBTIPO_ACTIVO, 
					TMP_COMPRAS.MONEDA, 
					TMP_COMPRAS.USO_INGRESOS,
					TMP_COMPRAS.TITULOS_COMPRADOS, 
					TMP_COMPRAS.PRECIO_TITULOS_COMPRADOS, 
					(CASE WHEN TMP_VENTAS.TITULOS_VENDIDOS IS NULL THEN 0.0000 ELSE TMP_VENTAS.TITULOS_VENDIDOS END) AS TITULOS_VENDIDOS,
					(CASE WHEN TMP_VENTAS.PRECIO_TITULOS_VENDIDOS IS NULL THEN 0.0000 ELSE TMP_VENTAS.PRECIO_TITULOS_VENDIDOS END) AS PRECIO_TITULOS_VENDIDOS
				FROM (
					SELECT 
						PRODUCTO_ID, 
						NOMBRE, 
						COMERCIALIZADOR, 
						MERCADO, 
						PROVEEDOR, 
						INSTRUMENTO, 
						TIPO_ACTIVO, 
						SUBTIPO_ACTIVO, 
						MONEDA, 
						USO_INGRESOS,
						CAST(SUM(NUMERO_TITULOS) AS DECIMAL(12, 4)) AS TITULOS_COMPRADOS, 
						CAST(SUM((NUMERO_TITULOS * PRECIO_TITULO) + COMISION) AS DECIMAL(12, 4)) AS PRECIO_TITULOS_COMPRADOS 
					FROM VW01_MOVIMIENTOS_PRODUCTOS
					WHERE COMPRA_VENTA = 'Compra' 
					AND TIPO_ACTIVO = 'Renta Fija'
					GROUP BY PRODUCTO_ID, NOMBRE, COMERCIALIZADOR, MERCADO, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS
				) 
				TMP_COMPRAS
				LEFT OUTER JOIN (
					SELECT 
						PRODUCTO_ID, 
						NOMBRE, 
						COMERCIALIZADOR, 
						MERCADO, 
						PROVEEDOR, 
						INSTRUMENTO, 
						TIPO_ACTIVO, 
						SUBTIPO_ACTIVO, 
						MONEDA, 
						USO_INGRESOS,
						CAST(SUM(NUMERO_TITULOS) AS DECIMAL(12, 4)) AS TITULOS_VENDIDOS, 
						CAST(SUM((NUMERO_TITULOS * PRECIO_TITULO) - COMISION) AS DECIMAL(12, 4)) AS PRECIO_TITULOS_VENDIDOS 
					FROM VW01_MOVIMIENTOS_PRODUCTOS
					WHERE COMPRA_VENTA = 'Venta' 
					AND TIPO_ACTIVO = 'Renta Fija'
					GROUP BY PRODUCTO_ID, NOMBRE, COMERCIALIZADOR, MERCADO, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS
				) 
				TMP_VENTAS
				ON TMP_COMPRAS.PRODUCTO_ID = TMP_VENTAS.PRODUCTO_ID 
				AND TMP_COMPRAS.NOMBRE = TMP_VENTAS.NOMBRE
				AND TMP_COMPRAS.COMERCIALIZADOR = TMP_VENTAS.COMERCIALIZADOR
				AND TMP_COMPRAS.MERCADO = TMP_VENTAS.MERCADO
				AND TMP_COMPRAS.PROVEEDOR = TMP_VENTAS.PROVEEDOR
				AND TMP_COMPRAS.INSTRUMENTO = TMP_VENTAS.INSTRUMENTO
				AND TMP_COMPRAS.TIPO_ACTIVO = TMP_VENTAS.TIPO_ACTIVO
				AND TMP_COMPRAS.SUBTIPO_ACTIVO = TMP_VENTAS.SUBTIPO_ACTIVO
				AND TMP_COMPRAS.MONEDA = TMP_VENTAS.MONEDA
				AND TMP_COMPRAS.USO_INGRESOS = TMP_VENTAS.USO_INGRESOS
			) 
			TMP_TITULOS_ACTUALES
			INNER JOIN TB02_PRODUCTOS_VAR PVAR 
			ON TMP_TITULOS_ACTUALES.PRODUCTO_ID = PVAR.PRODUCTO_ID
		)
		TMP_VALOR_TITULOS_ACTUALES
	)
	TMP_GANANCIA_PERDIDA
)
TMP_GANANCIA_PERDIDA_PRCNT;
0 rows inserted/updated/deleted
ij> --
--
--
CREATE VIEW VW02_GAN_PER_PROD_RV AS 
SELECT
	PRODUCTO_ID, 
	NOMBRE, 
	COMERCIALIZADOR, 
	MERCADO, 
	PROVEEDOR, 
	INSTRUMENTO, 
	TIPO_ACTIVO, 
	SUBTIPO_ACTIVO, 
	MONEDA, 
	USO_INGRESOS, 
	TER, 
	TITULOS_COMPRADOS, 
	PRECIO_TITULOS_COMPRADOS, 
	TITULOS_VENDIDOS, 
	PRECIO_TITULOS_VENDIDOS, 
	FLUJO_CAJA,
	TITULOS_ACTUALES, 
	VALOR_TITULO, 
	VALOR_TITULOS_ACTUALES,
	GANANCIA_PERDIDA,
	(CASE WHEN PRECIO_TITULOS_COMPRADOS > 0.0000 THEN CAST((GANANCIA_PERDIDA * 100.0000 / PRECIO_TITULOS_COMPRADOS) AS DECIMAL(12, 4)) ELSE 0.0000 END) AS GANANCIA_PERDIDA_PRCNT
FROM (
	SELECT
		PRODUCTO_ID, 
		NOMBRE, 
		COMERCIALIZADOR, 
		MERCADO, 
		PROVEEDOR, 
		INSTRUMENTO, 
		TIPO_ACTIVO, 
		SUBTIPO_ACTIVO, 
		MONEDA, 
		USO_INGRESOS, 
		TER, 
		TITULOS_COMPRADOS, 
		PRECIO_TITULOS_COMPRADOS, 
		TITULOS_VENDIDOS, 
		PRECIO_TITULOS_VENDIDOS, 
		FLUJO_CAJA,
		TITULOS_ACTUALES, 
		VALOR_TITULO, 
		VALOR_TITULOS_ACTUALES,
		CAST((PRECIO_TITULOS_VENDIDOS + VALOR_TITULOS_ACTUALES - PRECIO_TITULOS_COMPRADOS) AS DECIMAL(12, 4)) AS GANANCIA_PERDIDA 
	FROM (
		SELECT 
			PRODUCTO_ID, 
			NOMBRE, 
			COMERCIALIZADOR, 
			MERCADO, 
			PROVEEDOR, 
			INSTRUMENTO, 
			TIPO_ACTIVO, 
			SUBTIPO_ACTIVO, 
			MONEDA, 
			USO_INGRESOS, 
			TER, 
			TITULOS_COMPRADOS, 
			PRECIO_TITULOS_COMPRADOS, 
			TITULOS_VENDIDOS, 
			PRECIO_TITULOS_VENDIDOS, 
			FLUJO_CAJA,
			TITULOS_ACTUALES, 
			VALOR_TITULO, 
			CAST((TITULOS_ACTUALES * VALOR_TITULO) AS DECIMAL(12, 4)) AS VALOR_TITULOS_ACTUALES 
		FROM (
			SELECT 
				TMP_TITULOS_ACTUALES.PRODUCTO_ID, 
				TMP_TITULOS_ACTUALES.NOMBRE, 
				TMP_TITULOS_ACTUALES.COMERCIALIZADOR, 
				TMP_TITULOS_ACTUALES.MERCADO, 
				TMP_TITULOS_ACTUALES.PROVEEDOR, 
				TMP_TITULOS_ACTUALES.INSTRUMENTO, 
				TMP_TITULOS_ACTUALES.TIPO_ACTIVO, 
				TMP_TITULOS_ACTUALES.SUBTIPO_ACTIVO, 
				TMP_TITULOS_ACTUALES.MONEDA, 
				TMP_TITULOS_ACTUALES.USO_INGRESOS,				
				TMP_TITULOS_ACTUALES.TITULOS_COMPRADOS, 
				TMP_TITULOS_ACTUALES.PRECIO_TITULOS_COMPRADOS, 
				TMP_TITULOS_ACTUALES.TITULOS_VENDIDOS, 
				TMP_TITULOS_ACTUALES.PRECIO_TITULOS_VENDIDOS, 
				CAST((TMP_TITULOS_ACTUALES.PRECIO_TITULOS_VENDIDOS - TMP_TITULOS_ACTUALES.PRECIO_TITULOS_COMPRADOS) AS DECIMAL(12, 4)) AS FLUJO_CAJA, 
				CAST((TMP_TITULOS_ACTUALES.TITULOS_COMPRADOS - TMP_TITULOS_ACTUALES.TITULOS_VENDIDOS) AS DECIMAL(12, 4)) AS TITULOS_ACTUALES, 
				PVAR.VALOR_TITULO, 
				PVAR.TER
			FROM (
				SELECT 
					TMP_COMPRAS.PRODUCTO_ID, 
					TMP_COMPRAS.NOMBRE, 
					TMP_COMPRAS.COMERCIALIZADOR, 
					TMP_COMPRAS.MERCADO, 
					TMP_COMPRAS.PROVEEDOR, 
					TMP_COMPRAS.INSTRUMENTO, 
					TMP_COMPRAS.TIPO_ACTIVO, 
					TMP_COMPRAS.SUBTIPO_ACTIVO, 
					TMP_COMPRAS.MONEDA, 
					TMP_COMPRAS.USO_INGRESOS,
					TMP_COMPRAS.TITULOS_COMPRADOS, 
					TMP_COMPRAS.PRECIO_TITULOS_COMPRADOS, 
					(CASE WHEN TMP_VENTAS.TITULOS_VENDIDOS IS NULL THEN 0.0000 ELSE TMP_VENTAS.TITULOS_VENDIDOS END) AS TITULOS_VENDIDOS,
					(CASE WHEN TMP_VENTAS.PRECIO_TITULOS_VENDIDOS IS NULL THEN 0.0000 ELSE TMP_VENTAS.PRECIO_TITULOS_VENDIDOS END) AS PRECIO_TITULOS_VENDIDOS
				FROM (
					SELECT 
						PRODUCTO_ID, 
						NOMBRE, 
						COMERCIALIZADOR, 
						MERCADO, 
						PROVEEDOR, 
						INSTRUMENTO, 
						TIPO_ACTIVO, 
						SUBTIPO_ACTIVO, 
						MONEDA, 
						USO_INGRESOS,
						CAST(SUM(NUMERO_TITULOS) AS DECIMAL(12, 4)) AS TITULOS_COMPRADOS, 
						CAST(SUM((NUMERO_TITULOS * PRECIO_TITULO) + COMISION) AS DECIMAL(12, 4)) AS PRECIO_TITULOS_COMPRADOS 
					FROM VW01_MOVIMIENTOS_PRODUCTOS
					WHERE COMPRA_VENTA = 'Compra' 
					AND TIPO_ACTIVO = 'Renta Variable'
					GROUP BY PRODUCTO_ID, NOMBRE, COMERCIALIZADOR, MERCADO, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS
				) 
				TMP_COMPRAS
				LEFT OUTER JOIN (
					SELECT 
						PRODUCTO_ID, 
						NOMBRE, 
						COMERCIALIZADOR, 
						MERCADO, 
						PROVEEDOR, 
						INSTRUMENTO, 
						TIPO_ACTIVO, 
						SUBTIPO_ACTIVO, 
						MONEDA, 
						USO_INGRESOS,
						CAST(SUM(NUMERO_TITULOS) AS DECIMAL(12, 4)) AS TITULOS_VENDIDOS, 
						CAST(SUM((NUMERO_TITULOS * PRECIO_TITULO) - COMISION) AS DECIMAL(12, 4)) AS PRECIO_TITULOS_VENDIDOS 
					FROM VW01_MOVIMIENTOS_PRODUCTOS
					WHERE COMPRA_VENTA = 'Venta' 
					AND TIPO_ACTIVO = 'Renta Variable'
					GROUP BY PRODUCTO_ID, NOMBRE, COMERCIALIZADOR, MERCADO, PROVEEDOR, INSTRUMENTO, TIPO_ACTIVO, SUBTIPO_ACTIVO, MONEDA, USO_INGRESOS
				) 
				TMP_VENTAS
				ON TMP_COMPRAS.PRODUCTO_ID = TMP_VENTAS.PRODUCTO_ID 
				AND TMP_COMPRAS.NOMBRE = TMP_VENTAS.NOMBRE
				AND TMP_COMPRAS.COMERCIALIZADOR = TMP_VENTAS.COMERCIALIZADOR
				AND TMP_COMPRAS.MERCADO = TMP_VENTAS.MERCADO
				AND TMP_COMPRAS.PROVEEDOR = TMP_VENTAS.PROVEEDOR
				AND TMP_COMPRAS.INSTRUMENTO = TMP_VENTAS.INSTRUMENTO
				AND TMP_COMPRAS.TIPO_ACTIVO = TMP_VENTAS.TIPO_ACTIVO
				AND TMP_COMPRAS.SUBTIPO_ACTIVO = TMP_VENTAS.SUBTIPO_ACTIVO
				AND TMP_COMPRAS.MONEDA = TMP_VENTAS.MONEDA
				AND TMP_COMPRAS.USO_INGRESOS = TMP_VENTAS.USO_INGRESOS
			) 
			TMP_TITULOS_ACTUALES
			INNER JOIN TB02_PRODUCTOS_VAR PVAR 
			ON TMP_TITULOS_ACTUALES.PRODUCTO_ID = PVAR.PRODUCTO_ID
		)
		TMP_VALOR_TITULOS_ACTUALES
	)
	TMP_GANANCIA_PERDIDA
)
TMP_GANANCIA_PERDIDA_PRCNT;
0 rows inserted/updated/deleted
ij> --
--
--
CREATE VIEW VW03_GAN_PER_PROD_PESO_ORO AS 
SELECT
	PRODUCTO_ID, 
	NOMBRE, 
	COMERCIALIZADOR, 
	MERCADO, 
	PROVEEDOR, 
	INSTRUMENTO, 
	TIPO_ACTIVO, 
	SUBTIPO_ACTIVO, 
	MONEDA, 
	USO_INGRESOS, 
	TER, 
	TITULOS_COMPRADOS, 
	PRECIO_TITULOS_COMPRADOS, 
	TITULOS_VENDIDOS, 
	PRECIO_TITULOS_VENDIDOS, 
	FLUJO_CAJA,
	TITULOS_ACTUALES, 
	VALOR_TITULO, 
	VALOR_TITULOS_ACTUALES,
	GANANCIA_PERDIDA,
	GANANCIA_PERDIDA_PRCNT,
	(CASE WHEN SUM_VALOR_TITULOS_ACTUALES > 0.0000 THEN CAST((VALOR_TITULOS_ACTUALES * 100.0000 / SUM_VALOR_TITULOS_ACTUALES) AS DECIMAL(12, 4)) ELSE 0.0000 END) AS PESO_EN_CARTERA
FROM (
	SELECT 
		PRODUCTO_ID, 
		NOMBRE, 
		COMERCIALIZADOR, 
		MERCADO, 
		PROVEEDOR, 
		INSTRUMENTO, 
		TIPO_ACTIVO, 
		SUBTIPO_ACTIVO, 
		MONEDA, 
		USO_INGRESOS, 
		TER, 
		TITULOS_COMPRADOS, 
		PRECIO_TITULOS_COMPRADOS, 
		TITULOS_VENDIDOS, 
		PRECIO_TITULOS_VENDIDOS, 
		FLUJO_CAJA,
		TITULOS_ACTUALES, 
		VALOR_TITULO, 
		VALOR_TITULOS_ACTUALES,
		GANANCIA_PERDIDA,
		GANANCIA_PERDIDA_PRCNT,
		SUM_VALOR_TITULOS_ACTUALES
	FROM VW02_GAN_PER_PROD_ORO
	CROSS JOIN (
		SELECT SUM(VALOR_TITULOS_ACTUALES) AS SUM_VALOR_TITULOS_ACTUALES FROM VW02_GAN_PER_PROD_ORO
	) 
	TMP_SUM_VALOR_TITULOS_ACTUALES
)
TMP_GAN_PER_PROD_PESO;
0 rows inserted/updated/deleted
ij> --
--
--
CREATE VIEW VW03_GAN_PER_PROD_PESO_RF AS 
SELECT
	PRODUCTO_ID, 
	NOMBRE, 
	COMERCIALIZADOR, 
	MERCADO, 
	PROVEEDOR, 
	INSTRUMENTO, 
	TIPO_ACTIVO, 
	SUBTIPO_ACTIVO, 
	MONEDA, 
	USO_INGRESOS, 
	TER, 
	TITULOS_COMPRADOS, 
	PRECIO_TITULOS_COMPRADOS, 
	TITULOS_VENDIDOS, 
	PRECIO_TITULOS_VENDIDOS, 
	FLUJO_CAJA,
	TITULOS_ACTUALES, 
	VALOR_TITULO, 
	VALOR_TITULOS_ACTUALES,
	GANANCIA_PERDIDA,
	GANANCIA_PERDIDA_PRCNT,
	(CASE WHEN SUM_VALOR_TITULOS_ACTUALES > 0.0000 THEN CAST((VALOR_TITULOS_ACTUALES * 100.0000 / SUM_VALOR_TITULOS_ACTUALES) AS DECIMAL(12, 4)) ELSE 0.0000 END) AS PESO_EN_CARTERA
FROM (
	SELECT 
		PRODUCTO_ID, 
		NOMBRE, 
		COMERCIALIZADOR, 
		MERCADO, 
		PROVEEDOR, 
		INSTRUMENTO, 
		TIPO_ACTIVO, 
		SUBTIPO_ACTIVO, 
		MONEDA, 
		USO_INGRESOS, 
		TER, 
		TITULOS_COMPRADOS, 
		PRECIO_TITULOS_COMPRADOS, 
		TITULOS_VENDIDOS, 
		PRECIO_TITULOS_VENDIDOS, 
		FLUJO_CAJA,
		TITULOS_ACTUALES, 
		VALOR_TITULO, 
		VALOR_TITULOS_ACTUALES,
		GANANCIA_PERDIDA,
		GANANCIA_PERDIDA_PRCNT,
		SUM_VALOR_TITULOS_ACTUALES
	FROM VW02_GAN_PER_PROD_RF
	CROSS JOIN (
		SELECT SUM(VALOR_TITULOS_ACTUALES) AS SUM_VALOR_TITULOS_ACTUALES FROM VW02_GAN_PER_PROD_RF
	) 
	TMP_SUM_VALOR_TITULOS_ACTUALES
)
TMP_GAN_PER_PROD_PESO;
0 rows inserted/updated/deleted
ij> --
--
--
CREATE VIEW VW03_GAN_PER_PROD_PESO_RV AS 
SELECT
	PRODUCTO_ID, 
	NOMBRE, 
	COMERCIALIZADOR, 
	MERCADO, 
	PROVEEDOR, 
	INSTRUMENTO, 
	TIPO_ACTIVO, 
	SUBTIPO_ACTIVO, 
	MONEDA, 
	USO_INGRESOS, 
	TER, 
	TITULOS_COMPRADOS, 
	PRECIO_TITULOS_COMPRADOS, 
	TITULOS_VENDIDOS, 
	PRECIO_TITULOS_VENDIDOS, 
	FLUJO_CAJA,
	TITULOS_ACTUALES, 
	VALOR_TITULO, 
	VALOR_TITULOS_ACTUALES,
	GANANCIA_PERDIDA,
	GANANCIA_PERDIDA_PRCNT,
	(CASE WHEN SUM_VALOR_TITULOS_ACTUALES > 0.0000 THEN CAST((VALOR_TITULOS_ACTUALES * 100.0000 / SUM_VALOR_TITULOS_ACTUALES) AS DECIMAL(12, 4)) ELSE 0.0000 END) AS PESO_EN_CARTERA
FROM (
	SELECT 
		PRODUCTO_ID, 
		NOMBRE, 
		COMERCIALIZADOR, 
		MERCADO, 
		PROVEEDOR, 
		INSTRUMENTO, 
		TIPO_ACTIVO, 
		SUBTIPO_ACTIVO, 
		MONEDA, 
		USO_INGRESOS, 
		TER, 
		TITULOS_COMPRADOS, 
		PRECIO_TITULOS_COMPRADOS, 
		TITULOS_VENDIDOS, 
		PRECIO_TITULOS_VENDIDOS, 
		FLUJO_CAJA,
		TITULOS_ACTUALES, 
		VALOR_TITULO, 
		VALOR_TITULOS_ACTUALES,
		GANANCIA_PERDIDA,
		GANANCIA_PERDIDA_PRCNT,
		SUM_VALOR_TITULOS_ACTUALES
	FROM VW02_GAN_PER_PROD_RV
	CROSS JOIN (
		SELECT SUM(VALOR_TITULOS_ACTUALES) AS SUM_VALOR_TITULOS_ACTUALES FROM VW02_GAN_PER_PROD_RV
	) 
	TMP_SUM_VALOR_TITULOS_ACTUALES
)
TMP_GAN_PER_PROD_PESO;
0 rows inserted/updated/deleted
ij> --
--
--
CREATE VIEW VWF_SUBTIPO_ACTIVO_ORO AS 	
SELECT 
	SUBTIPO_ACTIVO AS "Oro",
	CAST(PRECIO_TITULOS_COMPRADOS AS DECIMAL(12, 4)) AS "Prec. Tit. C.", 
	CAST(PRECIO_TITULOS_VENDIDOS AS DECIMAL(12, 4)) AS "Prec. Tit. V.", 
	CAST(FLUJO_CAJA AS DECIMAL(12, 4)) AS "Flujo Caja", 
	CAST(VALOR_TITULOS_ACTUALES AS DECIMAL(12, 4)) AS "Val. Tit. Act.",
	CAST(GANANCIA_PERDIDA AS DECIMAL(12, 4)) AS "Gan./Perd.",
	(CASE WHEN PRECIO_TITULOS_COMPRADOS > 0.0000 THEN CAST((GANANCIA_PERDIDA * 100.0000 / PRECIO_TITULOS_COMPRADOS) AS DECIMAL(12, 4)) ELSE 0.0000 END) AS "Gan./Perd. %", 
	(CASE WHEN CAST(PESO_EN_CARTERA AS DECIMAL(12, 4)) >= 99.99 THEN 100.0000 ELSE CAST(PESO_EN_CARTERA AS DECIMAL(12, 4)) END) AS "Peso %" 
FROM (
	SELECT 
		SUBTIPO_ACTIVO,
		SUM(PRECIO_TITULOS_COMPRADOS) AS PRECIO_TITULOS_COMPRADOS, 
		SUM(PRECIO_TITULOS_VENDIDOS) AS PRECIO_TITULOS_VENDIDOS, 
		SUM(FLUJO_CAJA) AS FLUJO_CAJA, 
		SUM(VALOR_TITULOS_ACTUALES) VALOR_TITULOS_ACTUALES, 
		SUM(GANANCIA_PERDIDA) GANANCIA_PERDIDA, 
		SUM(PESO_EN_CARTERA) AS PESO_EN_CARTERA 
	FROM 
		VW03_GAN_PER_PROD_PESO_ORO
	GROUP BY
		SUBTIPO_ACTIVO
) 
TMP_GANANCIA_PERDIDA_PRCNT
ORDER BY 8;
0 rows inserted/updated/deleted
ij> --
--
--
CREATE VIEW VWF_SUBTIPO_ACTIVO_RF AS 	
SELECT 
	SUBTIPO_ACTIVO AS "Renta Fija",
	CAST(PRECIO_TITULOS_COMPRADOS AS DECIMAL(12, 4)) AS "Prec. Tit. C.", 
	CAST(PRECIO_TITULOS_VENDIDOS AS DECIMAL(12, 4)) AS "Prec. Tit. V.", 
	CAST(FLUJO_CAJA AS DECIMAL(12, 4)) AS "Flujo Caja", 
	CAST(VALOR_TITULOS_ACTUALES AS DECIMAL(12, 4)) AS "Val. Tit. Act.",
	CAST(GANANCIA_PERDIDA AS DECIMAL(12, 4)) AS "Gan./Perd.",
	(CASE WHEN PRECIO_TITULOS_COMPRADOS > 0.0000 THEN CAST((GANANCIA_PERDIDA * 100.0000 / PRECIO_TITULOS_COMPRADOS) AS DECIMAL(12, 4)) ELSE 0.0000 END) AS "Gan./Perd. %", 
	(CASE WHEN CAST(PESO_EN_CARTERA AS DECIMAL(12, 4)) >= 99.99 THEN 100.0000 ELSE CAST(PESO_EN_CARTERA AS DECIMAL(12, 4)) END) AS "Peso %" 
FROM (
	SELECT 
		SUBTIPO_ACTIVO,
		SUM(PRECIO_TITULOS_COMPRADOS) AS PRECIO_TITULOS_COMPRADOS, 
		SUM(PRECIO_TITULOS_VENDIDOS) AS PRECIO_TITULOS_VENDIDOS, 
		SUM(FLUJO_CAJA) AS FLUJO_CAJA, 
		SUM(VALOR_TITULOS_ACTUALES) VALOR_TITULOS_ACTUALES, 
		SUM(GANANCIA_PERDIDA) GANANCIA_PERDIDA, 
		SUM(PESO_EN_CARTERA) AS PESO_EN_CARTERA 
	FROM 
		VW03_GAN_PER_PROD_PESO_RF
	GROUP BY
		SUBTIPO_ACTIVO
) 
TMP_GANANCIA_PERDIDA_PRCNT
ORDER BY 8;
0 rows inserted/updated/deleted
ij> --
--
--
CREATE VIEW VWF_SUBTIPO_ACTIVO_RV AS 	
SELECT 
	SUBTIPO_ACTIVO AS "Renta Variable",
	CAST(PRECIO_TITULOS_COMPRADOS AS DECIMAL(12, 4)) AS "Prec. Tit. C.", 
	CAST(PRECIO_TITULOS_VENDIDOS AS DECIMAL(12, 4)) AS "Prec. Tit. V.", 
	CAST(FLUJO_CAJA AS DECIMAL(12, 4)) AS "Flujo Caja", 
	CAST(VALOR_TITULOS_ACTUALES AS DECIMAL(12, 4)) AS "Val. Tit. Act.",
	CAST(GANANCIA_PERDIDA AS DECIMAL(12, 4)) AS "Gan./Perd.",
	(CASE WHEN PRECIO_TITULOS_COMPRADOS > 0.0000 THEN CAST((GANANCIA_PERDIDA * 100.0000 / PRECIO_TITULOS_COMPRADOS) AS DECIMAL(12, 4)) ELSE 0.0000 END) AS "Gan./Perd. %", 
	(CASE WHEN CAST(PESO_EN_CARTERA AS DECIMAL(12, 4)) >= 99.99 THEN 100.0000 ELSE CAST(PESO_EN_CARTERA AS DECIMAL(12, 4)) END) AS "Peso %" 
FROM (
	SELECT 
		SUBTIPO_ACTIVO,
		SUM(PRECIO_TITULOS_COMPRADOS) AS PRECIO_TITULOS_COMPRADOS, 
		SUM(PRECIO_TITULOS_VENDIDOS) AS PRECIO_TITULOS_VENDIDOS, 
		SUM(FLUJO_CAJA) AS FLUJO_CAJA, 
		SUM(VALOR_TITULOS_ACTUALES) VALOR_TITULOS_ACTUALES, 
		SUM(GANANCIA_PERDIDA) GANANCIA_PERDIDA, 
		SUM(PESO_EN_CARTERA) AS PESO_EN_CARTERA 
	FROM 
		VW03_GAN_PER_PROD_PESO_RV
	GROUP BY
		SUBTIPO_ACTIVO
) 
TMP_GANANCIA_PERDIDA_PRCNT
ORDER BY 8;
0 rows inserted/updated/deleted
ij> 